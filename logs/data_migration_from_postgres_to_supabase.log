2025-03-29 10:35:46,076 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,175 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 10:35:46,179 - INFO - Saved visits per patient data to CSV.
2025-03-29 10:35:46,186 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,250 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 10:35:46,258 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,315 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 10:35:46,317 - INFO - Saved average visits per patient data to CSV.
2025-03-29 10:35:46,326 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,386 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 10:35:46,390 - INFO - Starting migration for patient_demographics...
2025-03-29 10:35:46,390 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,446 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-29 10:35:46,446 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-29 10:35:46,447 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,533 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-29 10:35:46,533 - INFO - Migration completed for patient_demographics.
2025-03-29 10:35:46,533 - INFO - Starting migration for patient_visits...
2025-03-29 10:35:46,534 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,584 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-29 10:35:46,584 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-29 10:35:46,585 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,659 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-29 10:35:46,659 - INFO - Migration completed for patient_visits.
2025-03-29 10:35:46,659 - INFO - Starting migration for patient_lab_results...
2025-03-29 10:35:46,660 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,711 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-29 10:35:46,711 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-29 10:35:46,712 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,759 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-29 10:35:46,759 - INFO - Migration completed for patient_lab_results.
2025-03-29 10:35:46,759 - INFO - Starting migration for patient_medications...
2025-03-29 10:35:46,759 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,814 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-29 10:35:46,814 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-29 10:35:46,815 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,874 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-29 10:35:46,874 - INFO - Migration completed for patient_medications.
2025-03-29 10:35:46,874 - INFO - Starting migration for physician_assignments...
2025-03-29 10:35:46,875 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,927 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-29 10:35:46,927 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-29 10:35:46,928 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,987 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-29 10:35:46,987 - INFO - Migration completed for physician_assignments.
2025-03-29 16:40:31,612 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:31,784 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 16:40:31,797 - INFO - Saved visits per patient data to CSV.
2025-03-29 16:40:31,816 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:31,891 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 16:40:31,899 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:31,963 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 16:40:31,964 - INFO - Saved average visits per patient data to CSV.
2025-03-29 16:40:31,971 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,027 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 16:40:32,030 - INFO - Starting migration for data_migration.patient_demographics...
2025-03-29 16:40:32,031 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,077 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_demographics" does not exist
LINE 1: SELECT * FROM data_migration.patient_demographics;
                      ^

[SQL: SELECT * FROM data_migration.patient_demographics;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,077 - INFO - Fetched data from PostgreSQL table data_migration.patient_demographics.
2025-03-29 16:40:32,077 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,077 - ERROR - Error inserting data into Supabase table data_migration.patient_demographics: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,077 - INFO - Migration completed for data_migration.patient_demographics.
2025-03-29 16:40:32,077 - INFO - Starting migration for data_migration.patient_visits...
2025-03-29 16:40:32,078 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,124 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_visits" does not exist
LINE 1: SELECT * FROM data_migration.patient_visits;
                      ^

[SQL: SELECT * FROM data_migration.patient_visits;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,124 - INFO - Fetched data from PostgreSQL table data_migration.patient_visits.
2025-03-29 16:40:32,125 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,125 - ERROR - Error inserting data into Supabase table data_migration.patient_visits: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,125 - INFO - Migration completed for data_migration.patient_visits.
2025-03-29 16:40:32,125 - INFO - Starting migration for data_migration.patient_lab_results...
2025-03-29 16:40:32,125 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,184 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_lab_results" does not exist
LINE 1: SELECT * FROM data_migration.patient_lab_results;
                      ^

[SQL: SELECT * FROM data_migration.patient_lab_results;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,184 - INFO - Fetched data from PostgreSQL table data_migration.patient_lab_results.
2025-03-29 16:40:32,185 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,185 - ERROR - Error inserting data into Supabase table data_migration.patient_lab_results: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,185 - INFO - Migration completed for data_migration.patient_lab_results.
2025-03-29 16:40:32,185 - INFO - Starting migration for data_migration.patient_medications...
2025-03-29 16:40:32,186 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,238 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_medications" does not exist
LINE 1: SELECT * FROM data_migration.patient_medications;
                      ^

[SQL: SELECT * FROM data_migration.patient_medications;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,238 - INFO - Fetched data from PostgreSQL table data_migration.patient_medications.
2025-03-29 16:40:32,239 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,239 - ERROR - Error inserting data into Supabase table data_migration.patient_medications: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,239 - INFO - Migration completed for data_migration.patient_medications.
2025-03-29 16:40:32,239 - INFO - Starting migration for data_migration.physician_assignments...
2025-03-29 16:40:32,239 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,283 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.physician_assignments" does not exist
LINE 1: SELECT * FROM data_migration.physician_assignments;
                      ^

[SQL: SELECT * FROM data_migration.physician_assignments;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,283 - INFO - Fetched data from PostgreSQL table data_migration.physician_assignments.
2025-03-29 16:40:32,284 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,284 - ERROR - Error inserting data into Supabase table data_migration.physician_assignments: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,284 - INFO - Migration completed for data_migration.physician_assignments.
2025-03-29 17:03:13,740 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:13,821 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 17:03:13,828 - INFO - Saved visits per patient data to CSV.
2025-03-29 17:03:13,835 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,007 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 17:03:14,015 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,070 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 17:03:14,072 - INFO - Saved average visits per patient data to CSV.
2025-03-29 17:03:14,077 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,137 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 17:03:14,142 - INFO - Starting migration for data_migration.patient_demographics...
2025-03-29 17:03:14,142 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,189 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_demographics" does not exist
LINE 1: SELECT * FROM data_migration.patient_demographics;
                      ^

[SQL: SELECT * FROM data_migration.patient_demographics;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,189 - INFO - Fetched data from PostgreSQL table data_migration.patient_demographics.
2025-03-29 17:03:14,190 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,190 - ERROR - Error inserting data into Supabase table data_migration.patient_demographics: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,190 - INFO - Migration completed for data_migration.patient_demographics.
2025-03-29 17:03:14,190 - INFO - Starting migration for data_migration.patient_visits...
2025-03-29 17:03:14,191 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,240 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_visits" does not exist
LINE 1: SELECT * FROM data_migration.patient_visits;
                      ^

[SQL: SELECT * FROM data_migration.patient_visits;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,240 - INFO - Fetched data from PostgreSQL table data_migration.patient_visits.
2025-03-29 17:03:14,241 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,241 - ERROR - Error inserting data into Supabase table data_migration.patient_visits: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,241 - INFO - Migration completed for data_migration.patient_visits.
2025-03-29 17:03:14,241 - INFO - Starting migration for data_migration.patient_lab_results...
2025-03-29 17:03:14,242 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,283 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_lab_results" does not exist
LINE 1: SELECT * FROM data_migration.patient_lab_results;
                      ^

[SQL: SELECT * FROM data_migration.patient_lab_results;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,283 - INFO - Fetched data from PostgreSQL table data_migration.patient_lab_results.
2025-03-29 17:03:14,283 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,284 - ERROR - Error inserting data into Supabase table data_migration.patient_lab_results: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,284 - INFO - Migration completed for data_migration.patient_lab_results.
2025-03-29 17:03:14,284 - INFO - Starting migration for data_migration.patient_medications...
2025-03-29 17:03:14,284 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,333 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_medications" does not exist
LINE 1: SELECT * FROM data_migration.patient_medications;
                      ^

[SQL: SELECT * FROM data_migration.patient_medications;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,334 - INFO - Fetched data from PostgreSQL table data_migration.patient_medications.
2025-03-29 17:03:14,334 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,334 - ERROR - Error inserting data into Supabase table data_migration.patient_medications: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,334 - INFO - Migration completed for data_migration.patient_medications.
2025-03-29 17:03:14,334 - INFO - Starting migration for data_migration.physician_assignments...
2025-03-29 17:03:14,335 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,377 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.physician_assignments" does not exist
LINE 1: SELECT * FROM data_migration.physician_assignments;
                      ^

[SQL: SELECT * FROM data_migration.physician_assignments;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,377 - INFO - Fetched data from PostgreSQL table data_migration.physician_assignments.
2025-03-29 17:03:14,377 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,377 - ERROR - Error inserting data into Supabase table data_migration.physician_assignments: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,377 - INFO - Migration completed for data_migration.physician_assignments.
2025-03-29 17:15:46,526 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,582 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 17:15:46,587 - INFO - Saved visits per patient data to CSV.
2025-03-29 17:15:46,591 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,645 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 17:15:46,652 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,702 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 17:15:46,703 - INFO - Saved average visits per patient data to CSV.
2025-03-29 17:15:46,707 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,755 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 17:15:46,759 - INFO - Starting migration for patient_demographics...
2025-03-29 17:15:46,759 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,818 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-29 17:15:46,818 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-29 17:15:46,819 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:46,855 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-29 17:15:46,855 - INFO - Migration completed for patient_demographics.
2025-03-29 17:15:46,855 - INFO - Starting migration for patient_visits...
2025-03-29 17:15:46,855 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,910 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-29 17:15:46,910 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-29 17:15:46,911 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:46,957 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-29 17:15:46,957 - INFO - Migration completed for patient_visits.
2025-03-29 17:15:46,958 - INFO - Starting migration for patient_lab_results...
2025-03-29 17:15:46,958 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:47,117 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-29 17:15:47,117 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-29 17:15:47,118 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:47,157 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-29 17:15:47,157 - INFO - Migration completed for patient_lab_results.
2025-03-29 17:15:47,157 - INFO - Starting migration for patient_medications...
2025-03-29 17:15:47,158 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:47,224 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-29 17:15:47,224 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-29 17:15:47,225 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:47,283 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-29 17:15:47,283 - INFO - Migration completed for patient_medications.
2025-03-29 17:15:47,284 - INFO - Starting migration for physician_assignments...
2025-03-29 17:15:47,285 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:47,345 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-29 17:15:47,345 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-29 17:15:47,346 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:47,374 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-29 17:15:47,374 - INFO - Migration completed for physician_assignments.
2025-03-30 23:01:59,261 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,338 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-30 23:01:59,341 - INFO - Saved visits per patient data to CSV.
2025-03-30 23:01:59,347 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,399 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-30 23:01:59,409 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,462 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-30 23:01:59,463 - INFO - Saved average visits per patient data to CSV.
2025-03-30 23:01:59,468 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,518 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-30 23:01:59,523 - INFO - Starting migration for patient_demographics...
2025-03-30 23:01:59,524 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,580 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-30 23:01:59,580 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-30 23:01:59,581 - INFO - Successfully connected to Supabase.
2025-03-30 23:01:59,649 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-30 23:01:59,649 - INFO - Migration completed for patient_demographics.
2025-03-30 23:01:59,649 - INFO - Starting migration for patient_visits...
2025-03-30 23:01:59,650 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,715 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-30 23:01:59,715 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-30 23:01:59,716 - INFO - Successfully connected to Supabase.
2025-03-30 23:01:59,770 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-30 23:01:59,770 - INFO - Migration completed for patient_visits.
2025-03-30 23:01:59,770 - INFO - Starting migration for patient_lab_results...
2025-03-30 23:01:59,771 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,835 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-30 23:01:59,836 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-30 23:01:59,836 - INFO - Successfully connected to Supabase.
2025-03-30 23:01:59,900 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-30 23:01:59,900 - INFO - Migration completed for patient_lab_results.
2025-03-30 23:01:59,900 - INFO - Starting migration for patient_medications...
2025-03-30 23:01:59,901 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,950 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-30 23:01:59,950 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-30 23:01:59,950 - INFO - Successfully connected to Supabase.
2025-03-30 23:02:00,027 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-30 23:02:00,028 - INFO - Migration completed for patient_medications.
2025-03-30 23:02:00,028 - INFO - Starting migration for physician_assignments...
2025-03-30 23:02:00,029 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:02:00,086 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-30 23:02:00,086 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-30 23:02:00,086 - INFO - Successfully connected to Supabase.
2025-03-30 23:02:00,144 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-30 23:02:00,144 - INFO - Migration completed for physician_assignments.
2025-03-31 08:41:53,651 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,738 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 08:41:53,741 - INFO - Saved visits per patient data to CSV.
2025-03-31 08:41:53,748 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,814 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 08:41:53,828 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,886 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 08:41:53,888 - INFO - Saved average visits per patient data to CSV.
2025-03-31 08:41:53,893 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,949 - ERROR - Error executing query: (psycopg2.errors.UndefinedFunction) function pg_catalog.extract(unknown, text) does not exist
LINE 2:     SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, CO...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 08:41:53,949 - ERROR - Error getting average visits per month: 'NoneType' object has no attribute 'to_csv'
2025-03-31 08:41:53,950 - INFO - Starting migration for patient_demographics...
2025-03-31 08:41:53,950 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,998 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 08:41:53,998 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 08:41:53,999 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,059 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 08:41:54,060 - INFO - Migration completed for patient_demographics.
2025-03-31 08:41:54,060 - INFO - Starting migration for patient_visits...
2025-03-31 08:41:54,060 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,114 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 08:41:54,114 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 08:41:54,115 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,180 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 08:41:54,180 - INFO - Migration completed for patient_visits.
2025-03-31 08:41:54,180 - INFO - Starting migration for patient_lab_results...
2025-03-31 08:41:54,181 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,228 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 08:41:54,228 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 08:41:54,228 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,292 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 08:41:54,293 - INFO - Migration completed for patient_lab_results.
2025-03-31 08:41:54,293 - INFO - Starting migration for patient_medications...
2025-03-31 08:41:54,294 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,349 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 08:41:54,349 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 08:41:54,350 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,395 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 08:41:54,395 - INFO - Migration completed for patient_medications.
2025-03-31 08:41:54,395 - INFO - Starting migration for physician_assignments...
2025-03-31 08:41:54,396 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,443 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 08:41:54,443 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 08:41:54,444 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,506 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 08:41:54,506 - INFO - Migration completed for physician_assignments.
2025-03-31 09:26:40,522 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,594 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:26:40,600 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:26:40,608 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,662 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:26:40,673 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,726 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:26:40,728 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:26:40,734 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,788 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:26:40,792 - INFO - Starting migration for patient_demographics...
2025-03-31 09:26:40,792 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,841 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:26:40,841 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:26:40,841 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:40,993 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:26:40,993 - INFO - Migration completed for patient_demographics.
2025-03-31 09:26:40,993 - INFO - Starting migration for patient_visits...
2025-03-31 09:26:40,994 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,050 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:26:41,050 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:26:41,051 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,218 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:26:41,218 - INFO - Migration completed for patient_visits.
2025-03-31 09:26:41,218 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:26:41,218 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,272 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:26:41,272 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:26:41,273 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,398 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:26:41,399 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:26:41,399 - INFO - Starting migration for patient_medications...
2025-03-31 09:26:41,399 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,458 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:26:41,458 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:26:41,459 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,593 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:26:41,593 - INFO - Migration completed for patient_medications.
2025-03-31 09:26:41,593 - INFO - Starting migration for physician_assignments...
2025-03-31 09:26:41,595 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,665 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:26:41,665 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:26:41,666 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,826 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:26:41,827 - INFO - Migration completed for physician_assignments.
2025-03-31 09:28:01,600 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,659 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:28:01,664 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:28:01,670 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,717 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:28:01,727 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,779 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:28:01,780 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:28:01,785 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,839 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:28:01,847 - INFO - Starting migration for patient_demographics...
2025-03-31 09:28:01,847 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,903 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:28:01,903 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:28:01,904 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,071 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:28:02,071 - INFO - Migration completed for patient_demographics.
2025-03-31 09:28:02,071 - INFO - Starting migration for patient_visits...
2025-03-31 09:28:02,072 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,126 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:28:02,126 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:28:02,127 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,238 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:28:02,238 - INFO - Migration completed for patient_visits.
2025-03-31 09:28:02,239 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:28:02,239 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,389 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:28:02,389 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:28:02,390 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,499 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:28:02,499 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:28:02,499 - INFO - Starting migration for patient_medications...
2025-03-31 09:28:02,499 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,559 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:28:02,559 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:28:02,559 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,686 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:28:02,686 - INFO - Migration completed for patient_medications.
2025-03-31 09:28:02,686 - INFO - Starting migration for physician_assignments...
2025-03-31 09:28:02,687 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,837 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:28:02,837 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:28:02,838 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,929 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:28:02,930 - INFO - Migration completed for physician_assignments.
2025-03-31 09:34:00,082 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,211 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:34:00,220 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:34:00,234 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,327 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:34:00,342 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,422 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:34:00,423 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:34:00,427 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,477 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:34:00,482 - INFO - Starting migration for patient_demographics...
2025-03-31 09:34:00,482 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,526 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:34:00,526 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:34:00,527 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:00,663 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:34:00,664 - INFO - Migration completed for patient_demographics.
2025-03-31 09:34:00,664 - INFO - Starting migration for patient_visits...
2025-03-31 09:34:00,665 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,760 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:34:00,760 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:34:00,761 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:00,892 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:34:00,892 - INFO - Migration completed for patient_visits.
2025-03-31 09:34:00,892 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:34:00,893 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,949 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:34:00,949 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:34:00,950 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:01,114 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:34:01,114 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:34:01,114 - INFO - Starting migration for patient_medications...
2025-03-31 09:34:01,116 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:01,189 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:34:01,189 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:34:01,190 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:01,333 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:34:01,333 - INFO - Migration completed for patient_medications.
2025-03-31 09:34:01,333 - INFO - Starting migration for physician_assignments...
2025-03-31 09:34:01,335 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:01,408 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:34:01,408 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:34:01,409 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:01,519 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:34:01,519 - INFO - Migration completed for physician_assignments.
2025-03-31 09:38:51,162 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,228 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:38:51,232 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:38:51,240 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,296 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:38:51,307 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,367 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:38:51,368 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:38:51,374 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,428 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:38:51,435 - INFO - Starting migration for patient_demographics...
2025-03-31 09:38:51,436 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,481 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:38:51,481 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:38:51,482 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:51,603 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:38:51,603 - INFO - Migration completed for patient_demographics.
2025-03-31 09:38:51,603 - INFO - Starting migration for patient_visits...
2025-03-31 09:38:51,604 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,663 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:38:51,663 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:38:51,664 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:51,779 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:38:51,779 - INFO - Migration completed for patient_visits.
2025-03-31 09:38:51,779 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:38:51,780 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,827 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:38:51,827 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:38:51,828 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:51,954 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:38:51,954 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:38:51,954 - INFO - Starting migration for patient_medications...
2025-03-31 09:38:51,955 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:52,002 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:38:52,002 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:38:52,003 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:52,150 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:38:52,150 - INFO - Migration completed for patient_medications.
2025-03-31 09:38:52,150 - INFO - Starting migration for physician_assignments...
2025-03-31 09:38:52,151 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:52,212 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:38:52,213 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:38:52,213 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:52,312 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:38:52,312 - INFO - Migration completed for physician_assignments.
2025-03-31 23:01:04,887 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:04,986 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 23:01:04,990 - INFO - Saved visits per patient data to CSV.
2025-03-31 23:01:04,995 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,057 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 23:01:05,067 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,125 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 23:01:05,127 - INFO - Saved average visits per patient data to CSV.
2025-03-31 23:01:05,131 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,181 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 23:01:05,185 - INFO - Starting migration for patient_demographics...
2025-03-31 23:01:05,186 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,234 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 23:01:05,234 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 23:01:05,235 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,269 - ERROR - Error inserting data into Supabase table patient_demographics: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_demographics (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_demographics (
	patient_id TEXT, 
	age BIGINT, 
	age_group TEXT, 
	gender TEXT, 
	patient_demographics_other_fields TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,270 - INFO - Migration completed for patient_demographics.
2025-03-31 23:01:05,270 - INFO - Starting migration for patient_visits...
2025-03-31 23:01:05,270 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,315 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 23:01:05,315 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 23:01:05,315 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,358 - ERROR - Error inserting data into Supabase table patient_visits: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_visits (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_visits (
	patient_id TEXT, 
	visit_id TEXT, 
	visit_date DATE, 
	visit_frequency BIGINT, 
	diagnosis TEXT, 
	medication TEXT, 
	patients_visits_other_fields TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,358 - INFO - Migration completed for patient_visits.
2025-03-31 23:01:05,359 - INFO - Starting migration for patient_lab_results...
2025-03-31 23:01:05,360 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,404 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 23:01:05,405 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 23:01:05,405 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,460 - ERROR - Error inserting data into Supabase table patient_lab_results: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_lab_results (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_lab_results (
	patient_id TEXT, 
	visit_id TEXT, 
	lab_test_id TEXT, 
	test_date DATE, 
	test_name TEXT, 
	result_value FLOAT(53), 
	result_unit TEXT, 
	reference_range TEXT, 
	patient_lab_results_notes TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,460 - INFO - Migration completed for patient_lab_results.
2025-03-31 23:01:05,460 - INFO - Starting migration for patient_medications...
2025-03-31 23:01:05,462 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,504 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 23:01:05,504 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 23:01:05,504 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,531 - ERROR - Error inserting data into Supabase table patient_medications: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_medications (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_medications (
	patient_id TEXT, 
	medication_id TEXT, 
	visit_id TEXT, 
	medication TEXT, 
	dosage_mg FLOAT(53), 
	start_date DATE, 
	end_date DATE, 
	patient_medications_notes TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,531 - INFO - Migration completed for patient_medications.
2025-03-31 23:01:05,531 - INFO - Starting migration for physician_assignments...
2025-03-31 23:01:05,531 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,576 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 23:01:05,576 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 23:01:05,576 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,621 - ERROR - Error inserting data into Supabase table physician_assignments: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.physician_assignments (
                     ^

[SQL: 
CREATE TABLE data_migration.physician_assignments (
	patient_id TEXT, 
	visit_id TEXT, 
	physician_id TEXT, 
	physician_name TEXT, 
	assignment_date DATE, 
	department TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,621 - INFO - Migration completed for physician_assignments.
2025-03-31 23:02:21,647 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,743 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 23:02:21,746 - INFO - Saved visits per patient data to CSV.
2025-03-31 23:02:21,753 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,809 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 23:02:21,821 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,877 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 23:02:21,878 - INFO - Saved average visits per patient data to CSV.
2025-03-31 23:02:21,883 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,938 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 23:02:21,942 - INFO - Starting migration for patient_demographics...
2025-03-31 23:02:21,942 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,994 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 23:02:21,994 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 23:02:21,994 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,042 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 23:02:22,042 - INFO - Migration completed for patient_demographics.
2025-03-31 23:02:22,042 - INFO - Starting migration for patient_visits...
2025-03-31 23:02:22,042 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,111 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 23:02:22,111 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 23:02:22,112 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,176 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 23:02:22,177 - INFO - Migration completed for patient_visits.
2025-03-31 23:02:22,177 - INFO - Starting migration for patient_lab_results...
2025-03-31 23:02:22,177 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,229 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 23:02:22,229 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 23:02:22,230 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,291 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 23:02:22,291 - INFO - Migration completed for patient_lab_results.
2025-03-31 23:02:22,291 - INFO - Starting migration for patient_medications...
2025-03-31 23:02:22,292 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,352 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 23:02:22,352 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 23:02:22,353 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,424 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 23:02:22,424 - INFO - Migration completed for patient_medications.
2025-03-31 23:02:22,424 - INFO - Starting migration for physician_assignments...
2025-03-31 23:02:22,425 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,509 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 23:02:22,509 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 23:02:22,510 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,587 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 23:02:22,587 - INFO - Migration completed for physician_assignments.
2025-04-01 10:28:06,154 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,215 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-04-01 10:28:06,219 - INFO - Saved visits per patient data to CSV.
2025-04-01 10:28:06,225 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,280 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 10:28:06,290 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,338 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 10:28:06,339 - INFO - Saved average visits per patient data to CSV.
2025-04-01 10:28:06,344 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,392 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 10:28:06,396 - INFO - Starting migration for patient_demographics...
2025-04-01 10:28:06,398 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,450 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 10:28:06,450 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 10:28:06,450 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:06,546 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 10:28:06,547 - INFO - Migration completed for patient_demographics.
2025-04-01 10:28:06,547 - INFO - Starting migration for patient_visits...
2025-04-01 10:28:06,547 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,610 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 10:28:06,610 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 10:28:06,611 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:06,708 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 10:28:06,708 - INFO - Migration completed for patient_visits.
2025-04-01 10:28:06,708 - INFO - Starting migration for patient_lab_results...
2025-04-01 10:28:06,709 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,760 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 10:28:06,760 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 10:28:06,761 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:06,872 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 10:28:06,872 - INFO - Migration completed for patient_lab_results.
2025-04-01 10:28:06,872 - INFO - Starting migration for patient_medications...
2025-04-01 10:28:06,873 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,924 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 10:28:06,924 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 10:28:06,925 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:07,036 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 10:28:07,036 - INFO - Migration completed for patient_medications.
2025-04-01 10:28:07,036 - INFO - Starting migration for physician_assignments...
2025-04-01 10:28:07,037 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:07,089 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 10:28:07,089 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 10:28:07,090 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:07,173 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 10:28:07,173 - INFO - Migration completed for physician_assignments.
2025-04-01 10:53:04,017 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,080 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-04-01 10:53:04,084 - INFO - Saved visits per patient data to CSV.
2025-04-01 10:53:04,090 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,144 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 10:53:04,155 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,312 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 10:53:04,313 - INFO - Saved average visits per patient data to CSV.
2025-04-01 10:53:04,319 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,380 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 10:53:04,389 - INFO - Starting migration for patient_demographics...
2025-04-01 10:53:04,390 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,450 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 10:53:04,450 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 10:53:04,452 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:04,593 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 10:53:04,593 - INFO - Migration completed for patient_demographics.
2025-04-01 10:53:04,593 - INFO - Starting migration for patient_visits...
2025-04-01 10:53:04,594 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,688 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 10:53:04,688 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 10:53:04,688 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:04,867 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 10:53:04,867 - INFO - Migration completed for patient_visits.
2025-04-01 10:53:04,867 - INFO - Starting migration for patient_lab_results...
2025-04-01 10:53:04,868 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,923 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 10:53:04,923 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 10:53:04,923 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:05,045 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 10:53:05,045 - INFO - Migration completed for patient_lab_results.
2025-04-01 10:53:05,046 - INFO - Starting migration for patient_medications...
2025-04-01 10:53:05,046 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:05,200 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 10:53:05,200 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 10:53:05,201 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:05,310 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 10:53:05,310 - INFO - Migration completed for patient_medications.
2025-04-01 10:53:05,310 - INFO - Starting migration for physician_assignments...
2025-04-01 10:53:05,311 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:05,369 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 10:53:05,369 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 10:53:05,370 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:05,500 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 10:53:05,500 - INFO - Migration completed for physician_assignments.
2025-04-01 14:23:21,773 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,831 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-04-01 14:23:21,834 - INFO - Saved visits per patient data to CSV.
2025-04-01 14:23:21,839 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,887 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 14:23:21,895 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,941 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 14:23:21,942 - INFO - Saved average visits per patient data to CSV.
2025-04-01 14:23:21,948 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,998 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 14:23:22,002 - INFO - Starting migration for patient_demographics...
2025-04-01 14:23:22,002 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,052 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 14:23:22,052 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 14:23:22,053 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,180 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 14:23:22,180 - INFO - Migration completed for patient_demographics.
2025-04-01 14:23:22,180 - INFO - Starting migration for patient_visits...
2025-04-01 14:23:22,181 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,251 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 14:23:22,251 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 14:23:22,252 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,364 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 14:23:22,364 - INFO - Migration completed for patient_visits.
2025-04-01 14:23:22,364 - INFO - Starting migration for patient_lab_results...
2025-04-01 14:23:22,365 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,415 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 14:23:22,415 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 14:23:22,416 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,539 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 14:23:22,539 - INFO - Migration completed for patient_lab_results.
2025-04-01 14:23:22,539 - INFO - Starting migration for patient_medications...
2025-04-01 14:23:22,540 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,593 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 14:23:22,593 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 14:23:22,594 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,777 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 14:23:22,777 - INFO - Migration completed for patient_medications.
2025-04-01 14:23:22,777 - INFO - Starting migration for physician_assignments...
2025-04-01 14:23:22,778 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,844 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 14:23:22,844 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 14:23:22,845 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,972 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 14:23:22,972 - INFO - Migration completed for physician_assignments.
2025-04-01 14:41:10,217 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,307 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id;
    
2025-04-01 14:41:10,310 - INFO - Saved visits per patient data to CSV.
2025-04-01 14:41:10,316 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,365 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 14:41:10,374 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,424 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 14:41:10,426 - INFO - Saved average visits per patient data to CSV.
2025-04-01 14:41:10,431 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,480 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 14:41:10,485 - INFO - Starting migration for patient_demographics...
2025-04-01 14:41:10,486 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,538 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 14:41:10,538 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 14:41:10,539 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:10,690 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 14:41:10,690 - INFO - Migration completed for patient_demographics.
2025-04-01 14:41:10,690 - INFO - Starting migration for patient_visits...
2025-04-01 14:41:10,691 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,756 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 14:41:10,756 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 14:41:10,757 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:10,873 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 14:41:10,873 - INFO - Migration completed for patient_visits.
2025-04-01 14:41:10,873 - INFO - Starting migration for patient_lab_results...
2025-04-01 14:41:10,874 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:10,934 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 14:41:10,935 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 14:41:10,935 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:11,052 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 14:41:11,052 - INFO - Migration completed for patient_lab_results.
2025-04-01 14:41:11,052 - INFO - Starting migration for patient_medications...
2025-04-01 14:41:11,053 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:11,098 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 14:41:11,098 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 14:41:11,099 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:11,216 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 14:41:11,216 - INFO - Migration completed for patient_medications.
2025-04-01 14:41:11,216 - INFO - Starting migration for physician_assignments...
2025-04-01 14:41:11,217 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:11,270 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 14:41:11,270 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 14:41:11,271 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:11,380 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 14:41:11,380 - INFO - Migration completed for physician_assignments.
2025-04-01 14:41:58,277 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:58,336 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-01 14:41:58,338 - INFO - Saved visits per patient data to CSV.
2025-04-01 14:41:58,343 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:58,405 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 14:41:58,412 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:58,460 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 14:41:58,461 - INFO - Saved average visits per patient data to CSV.
2025-04-01 14:41:58,465 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:58,511 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 14:41:58,519 - INFO - Starting migration for patient_demographics...
2025-04-01 14:41:58,520 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:58,695 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 14:41:58,695 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 14:41:58,696 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:58,837 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 14:41:58,837 - INFO - Migration completed for patient_demographics.
2025-04-01 14:41:58,837 - INFO - Starting migration for patient_visits...
2025-04-01 14:41:58,837 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:58,904 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 14:41:58,904 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 14:41:58,905 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:59,025 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 14:41:59,025 - INFO - Migration completed for patient_visits.
2025-04-01 14:41:59,025 - INFO - Starting migration for patient_lab_results...
2025-04-01 14:41:59,026 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:59,098 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 14:41:59,098 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 14:41:59,099 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:59,344 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 14:41:59,345 - INFO - Migration completed for patient_lab_results.
2025-04-01 14:41:59,345 - INFO - Starting migration for patient_medications...
2025-04-01 14:41:59,348 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:59,440 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 14:41:59,440 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 14:41:59,440 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:59,590 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 14:41:59,590 - INFO - Migration completed for patient_medications.
2025-04-01 14:41:59,590 - INFO - Starting migration for physician_assignments...
2025-04-01 14:41:59,591 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:41:59,650 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 14:41:59,650 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 14:41:59,650 - INFO - Successfully connected to Supabase.
2025-04-01 14:41:59,765 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 14:41:59,765 - INFO - Migration completed for physician_assignments.
2025-04-02 14:19:04,611 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:04,959 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-02 14:19:04,967 - INFO - Saved visits per patient data to CSV.
2025-04-02 14:19:04,977 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:05,168 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 5:     OR visit_date BETWEEN '{start_date}' AND '{end_date}';
                                  ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}'
    OR visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-02 14:19:05,168 - ERROR - Error getting patients by diagnosis or visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-02 14:19:05,169 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:05,235 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-02 14:19:05,238 - INFO - Saved average visits per patient data to CSV.
2025-04-02 14:19:05,247 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:05,320 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-02 14:19:05,326 - INFO - Starting migration for patient_demographics...
2025-04-02 14:19:05,326 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:05,404 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-02 14:19:05,404 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-02 14:19:05,405 - INFO - Successfully connected to Supabase.
2025-04-02 14:19:05,774 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-02 14:19:05,774 - INFO - Migration completed for patient_demographics.
2025-04-02 14:19:05,774 - INFO - Starting migration for patient_visits...
2025-04-02 14:19:05,775 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:05,860 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-02 14:19:05,860 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-02 14:19:05,861 - INFO - Successfully connected to Supabase.
2025-04-02 14:19:06,018 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-02 14:19:06,018 - INFO - Migration completed for patient_visits.
2025-04-02 14:19:06,018 - INFO - Starting migration for patient_lab_results...
2025-04-02 14:19:06,019 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:06,090 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-02 14:19:06,090 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-02 14:19:06,091 - INFO - Successfully connected to Supabase.
2025-04-02 14:19:06,232 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-02 14:19:06,232 - INFO - Migration completed for patient_lab_results.
2025-04-02 14:19:06,232 - INFO - Starting migration for patient_medications...
2025-04-02 14:19:06,233 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:06,298 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-02 14:19:06,298 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-02 14:19:06,299 - INFO - Successfully connected to Supabase.
2025-04-02 14:19:06,451 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-02 14:19:06,451 - INFO - Migration completed for patient_medications.
2025-04-02 14:19:06,451 - INFO - Starting migration for physician_assignments...
2025-04-02 14:19:06,452 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:19:06,552 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-02 14:19:06,552 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-02 14:19:06,553 - INFO - Successfully connected to Supabase.
2025-04-02 14:19:06,729 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-02 14:19:06,730 - INFO - Migration completed for physician_assignments.
2025-04-02 14:39:57,913 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:39:58,100 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-02 14:39:58,107 - INFO - Saved visits per patient data to CSV.
2025-04-02 14:45:39,567 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:45:39,848 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-02 14:45:39,860 - INFO - Saved visits per patient data to CSV.
2025-04-02 14:45:50,743 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:45:50,994 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 5:     OR visit_date BETWEEN '{start_date}' AND '{end_date}';
                                  ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}'
    OR visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-02 14:45:50,995 - ERROR - Error getting patients by diagnosis or visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-02 14:45:50,996 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:45:51,060 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-02 14:45:51,062 - INFO - Saved average visits per patient data to CSV.
2025-04-02 14:45:51,068 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:45:51,129 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-02 14:45:51,130 - INFO - Saved visits per month data to CSV.
2025-04-02 14:46:18,229 - INFO - Starting migration for patient_demographics...
2025-04-02 14:46:18,231 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:46:18,356 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-02 14:46:18,356 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-02 14:46:18,357 - INFO - Successfully connected to Supabase.
2025-04-02 14:46:18,641 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-02 14:46:18,641 - INFO - Migration completed for patient_demographics.
2025-04-02 14:46:18,641 - INFO - Starting migration for patient_visits...
2025-04-02 14:46:18,642 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:46:18,710 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-02 14:46:18,710 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-02 14:46:18,711 - INFO - Successfully connected to Supabase.
2025-04-02 14:46:18,849 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-02 14:46:18,850 - INFO - Migration completed for patient_visits.
2025-04-02 14:46:18,850 - INFO - Starting migration for patient_lab_results...
2025-04-02 14:46:18,850 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:46:18,918 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-02 14:46:18,918 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-02 14:46:18,918 - INFO - Successfully connected to Supabase.
2025-04-02 14:46:19,056 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-02 14:46:19,057 - INFO - Migration completed for patient_lab_results.
2025-04-02 14:46:19,057 - INFO - Starting migration for patient_medications...
2025-04-02 14:46:19,057 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:46:19,121 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-02 14:46:19,121 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-02 14:46:19,122 - INFO - Successfully connected to Supabase.
2025-04-02 14:46:19,267 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-02 14:46:19,267 - INFO - Migration completed for patient_medications.
2025-04-02 14:46:19,267 - INFO - Starting migration for physician_assignments...
2025-04-02 14:46:19,268 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:46:19,339 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-02 14:46:19,340 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-02 14:46:19,340 - INFO - Successfully connected to Supabase.
2025-04-02 14:46:19,581 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-02 14:46:19,581 - INFO - Migration completed for physician_assignments.
2025-04-02 14:52:44,393 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:52:44,542 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-02 14:52:44,550 - INFO - Saved visits per patient data to CSV.
2025-04-02 14:52:48,703 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:52:48,906 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 5:     OR visit_date BETWEEN '{start_date}' AND '{end_date}';
                                  ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}'
    OR visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-02 14:52:48,906 - ERROR - Error getting patients by diagnosis or visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-02 14:52:48,907 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:52:48,980 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-02 14:52:48,982 - INFO - Saved average visits per patient data to CSV.
2025-04-02 14:53:17,807 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:53:17,931 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-02 14:53:17,934 - INFO - Saved visits per month data to CSV.
2025-04-02 14:53:21,347 - INFO - Starting migration for patient_demographics...
2025-04-02 14:53:21,349 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:53:21,546 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-02 14:53:21,546 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-02 14:53:21,549 - INFO - Successfully connected to Supabase.
2025-04-02 14:53:21,767 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-02 14:53:21,768 - INFO - Migration completed for patient_demographics.
2025-04-02 14:53:21,768 - INFO - Starting migration for patient_visits...
2025-04-02 14:53:21,769 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:53:21,959 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-02 14:53:21,959 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-02 14:53:21,960 - INFO - Successfully connected to Supabase.
2025-04-02 14:53:22,109 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-02 14:53:22,109 - INFO - Migration completed for patient_visits.
2025-04-02 14:53:22,109 - INFO - Starting migration for patient_lab_results...
2025-04-02 14:53:22,110 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:53:22,175 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-02 14:53:22,175 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-02 14:53:22,176 - INFO - Successfully connected to Supabase.
2025-04-02 14:53:22,308 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-02 14:53:22,308 - INFO - Migration completed for patient_lab_results.
2025-04-02 14:53:22,308 - INFO - Starting migration for patient_medications...
2025-04-02 14:53:22,309 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:53:22,411 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-02 14:53:22,412 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-02 14:53:22,412 - INFO - Successfully connected to Supabase.
2025-04-02 14:53:22,589 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-02 14:53:22,589 - INFO - Migration completed for patient_medications.
2025-04-02 14:53:22,589 - INFO - Starting migration for physician_assignments...
2025-04-02 14:53:22,590 - INFO - Successfully connected to PostgreSQL.
2025-04-02 14:53:22,769 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-02 14:53:22,769 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-02 14:53:22,770 - INFO - Successfully connected to Supabase.
2025-04-02 14:53:22,872 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-02 14:53:22,872 - INFO - Migration completed for physician_assignments.
2025-04-10 11:58:19,106 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:58:19,267 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 11:58:19,274 - INFO - Saved visits per patient data to CSV.
2025-04-10 11:58:35,615 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:58:35,724 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}';
    
2025-04-10 11:58:35,726 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 11:59:05,005 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:05,207 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 4:     WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}...
                                      ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-10 11:59:05,207 - ERROR - Error getting patients by visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-10 11:59:05,208 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:05,273 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 11:59:05,274 - INFO - Saved average visits per patient data to CSV.
2025-04-10 11:59:17,414 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:17,530 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 11:59:17,532 - INFO - Saved visits per month data to CSV.
2025-04-10 11:59:23,181 - INFO - Starting migration for patient_demographics...
2025-04-10 11:59:23,182 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:23,306 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 11:59:23,306 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 11:59:23,307 - INFO - Successfully connected to Supabase.
2025-04-10 11:59:23,573 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 11:59:23,573 - INFO - Migration completed for patient_demographics.
2025-04-10 11:59:23,573 - INFO - Starting migration for patient_visits...
2025-04-10 11:59:23,576 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:23,679 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 11:59:23,679 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 11:59:23,680 - INFO - Successfully connected to Supabase.
2025-04-10 11:59:23,859 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 11:59:23,860 - INFO - Migration completed for patient_visits.
2025-04-10 11:59:23,860 - INFO - Starting migration for patient_lab_results...
2025-04-10 11:59:23,861 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:24,043 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 11:59:24,043 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 11:59:24,044 - INFO - Successfully connected to Supabase.
2025-04-10 11:59:24,164 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 11:59:24,164 - INFO - Migration completed for patient_lab_results.
2025-04-10 11:59:24,164 - INFO - Starting migration for patient_medications...
2025-04-10 11:59:24,165 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:24,236 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 11:59:24,237 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 11:59:24,237 - INFO - Successfully connected to Supabase.
2025-04-10 11:59:24,418 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 11:59:24,418 - INFO - Migration completed for patient_medications.
2025-04-10 11:59:24,418 - INFO - Starting migration for physician_assignments...
2025-04-10 11:59:24,419 - INFO - Successfully connected to PostgreSQL.
2025-04-10 11:59:24,483 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 11:59:24,484 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 11:59:24,484 - INFO - Successfully connected to Supabase.
2025-04-10 11:59:24,602 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 11:59:24,602 - INFO - Migration completed for physician_assignments.
2025-04-10 12:00:59,707 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:00:59,780 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:00:59,785 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:01:04,397 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:04,615 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}';
    
2025-04-10 12:01:04,616 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:01:13,436 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:13,629 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 4:     WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}...
                                      ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-10 12:01:13,630 - ERROR - Error getting patients by visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-10 12:01:13,632 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:13,748 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:01:13,750 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:01:15,408 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:15,496 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:01:15,497 - INFO - Saved visits per month data to CSV.
2025-04-10 12:01:17,435 - INFO - Starting migration for patient_demographics...
2025-04-10 12:01:17,436 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:17,517 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:01:17,517 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:01:17,517 - INFO - Successfully connected to Supabase.
2025-04-10 12:01:17,671 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:01:17,672 - INFO - Migration completed for patient_demographics.
2025-04-10 12:01:17,672 - INFO - Starting migration for patient_visits...
2025-04-10 12:01:17,672 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:17,756 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:01:17,756 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:01:17,757 - INFO - Successfully connected to Supabase.
2025-04-10 12:01:17,884 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:01:17,884 - INFO - Migration completed for patient_visits.
2025-04-10 12:01:17,885 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:01:17,887 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:17,955 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:01:17,955 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:01:17,956 - INFO - Successfully connected to Supabase.
2025-04-10 12:01:18,105 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:01:18,105 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:01:18,105 - INFO - Starting migration for patient_medications...
2025-04-10 12:01:18,106 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:18,190 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:01:18,191 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:01:18,192 - INFO - Successfully connected to Supabase.
2025-04-10 12:01:18,474 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:01:18,474 - INFO - Migration completed for patient_medications.
2025-04-10 12:01:18,474 - INFO - Starting migration for physician_assignments...
2025-04-10 12:01:18,475 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:01:18,660 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:01:18,661 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:01:18,661 - INFO - Successfully connected to Supabase.
2025-04-10 12:01:18,810 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:01:18,810 - INFO - Migration completed for physician_assignments.
2025-04-10 12:03:41,290 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:41,462 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:03:41,465 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:03:43,381 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:43,493 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}';
    
2025-04-10 12:03:43,495 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:03:48,480 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:48,679 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 4:     WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}...
                                      ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-10 12:03:48,679 - ERROR - Error getting patients by visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-10 12:03:48,680 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:48,743 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:03:48,744 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:03:50,609 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:50,695 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:03:50,696 - INFO - Saved visits per month data to CSV.
2025-04-10 12:03:52,541 - INFO - Starting migration for patient_demographics...
2025-04-10 12:03:52,541 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:52,649 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:03:52,649 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:03:52,653 - INFO - Successfully connected to Supabase.
2025-04-10 12:03:52,788 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:03:52,789 - INFO - Migration completed for patient_demographics.
2025-04-10 12:03:52,789 - INFO - Starting migration for patient_visits...
2025-04-10 12:03:52,790 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:52,967 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:03:52,967 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:03:52,968 - INFO - Successfully connected to Supabase.
2025-04-10 12:03:53,098 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:03:53,099 - INFO - Migration completed for patient_visits.
2025-04-10 12:03:53,100 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:03:53,101 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:53,181 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:03:53,181 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:03:53,183 - INFO - Successfully connected to Supabase.
2025-04-10 12:03:53,313 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:03:53,313 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:03:53,313 - INFO - Starting migration for patient_medications...
2025-04-10 12:03:53,314 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:53,391 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:03:53,391 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:03:53,392 - INFO - Successfully connected to Supabase.
2025-04-10 12:03:53,679 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:03:53,679 - INFO - Migration completed for patient_medications.
2025-04-10 12:03:53,679 - INFO - Starting migration for physician_assignments...
2025-04-10 12:03:53,680 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:03:53,838 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:03:53,838 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:03:53,840 - INFO - Successfully connected to Supabase.
2025-04-10 12:03:54,051 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:03:54,051 - INFO - Migration completed for physician_assignments.
2025-04-10 12:06:37,221 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:37,292 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:06:37,295 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:06:39,685 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:39,803 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis
    FROM patient_visits
    WHERE diagnosis = '{diagnosis}';
    
2025-04-10 12:06:39,804 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:06:41,880 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:41,973 - ERROR - Error executing query: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: "{start_date}"
LINE 4:     WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}...
                                      ^

[SQL: 
    SELECT * 
    FROM patient_visits
    WHERE  visit_date BETWEEN '{start_date}' AND '{end_date}';
    ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-04-10 12:06:41,973 - ERROR - Error getting patients by visit date: 'NoneType' object has no attribute 'to_csv'
2025-04-10 12:06:41,974 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:42,045 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:06:42,047 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:06:44,019 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:44,115 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:06:44,116 - INFO - Saved visits per month data to CSV.
2025-04-10 12:06:46,142 - INFO - Starting migration for patient_demographics...
2025-04-10 12:06:46,144 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:46,264 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:06:46,264 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:06:46,264 - INFO - Successfully connected to Supabase.
2025-04-10 12:06:46,421 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:06:46,421 - INFO - Migration completed for patient_demographics.
2025-04-10 12:06:46,421 - INFO - Starting migration for patient_visits...
2025-04-10 12:06:46,422 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:46,510 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:06:46,510 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:06:46,511 - INFO - Successfully connected to Supabase.
2025-04-10 12:06:46,680 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:06:46,681 - INFO - Migration completed for patient_visits.
2025-04-10 12:06:46,681 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:06:46,682 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:46,772 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:06:46,772 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:06:46,774 - INFO - Successfully connected to Supabase.
2025-04-10 12:06:46,903 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:06:46,903 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:06:46,903 - INFO - Starting migration for patient_medications...
2025-04-10 12:06:46,903 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:46,956 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:06:46,956 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:06:46,957 - INFO - Successfully connected to Supabase.
2025-04-10 12:06:47,143 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:06:47,143 - INFO - Migration completed for patient_medications.
2025-04-10 12:06:47,143 - INFO - Starting migration for physician_assignments...
2025-04-10 12:06:47,144 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:06:47,197 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:06:47,197 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:06:47,198 - INFO - Successfully connected to Supabase.
2025-04-10 12:06:47,305 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:06:47,305 - INFO - Migration completed for physician_assignments.
2025-04-10 12:08:59,370 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:08:59,464 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:08:59,468 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:09:04,310 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:04,536 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION';
    
2025-04-10 12:09:04,537 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:09:16,553 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:16,685 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE  visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-10 12:09:16,687 - INFO - Saved patients by vist date to CSV.
2025-04-10 12:09:29,388 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:29,496 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:09:29,498 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:09:33,338 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:33,454 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:09:33,456 - INFO - Saved visits per month data to CSV.
2025-04-10 12:09:36,091 - INFO - Starting migration for patient_demographics...
2025-04-10 12:09:36,092 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:36,257 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:09:36,257 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:09:36,258 - INFO - Successfully connected to Supabase.
2025-04-10 12:09:36,418 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:09:36,418 - INFO - Migration completed for patient_demographics.
2025-04-10 12:09:36,419 - INFO - Starting migration for patient_visits...
2025-04-10 12:09:36,419 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:36,484 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:09:36,484 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:09:36,485 - INFO - Successfully connected to Supabase.
2025-04-10 12:09:36,617 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:09:36,617 - INFO - Migration completed for patient_visits.
2025-04-10 12:09:36,617 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:09:36,618 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:36,689 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:09:36,689 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:09:36,691 - INFO - Successfully connected to Supabase.
2025-04-10 12:09:36,946 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:09:36,946 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:09:36,946 - INFO - Starting migration for patient_medications...
2025-04-10 12:09:36,947 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:37,008 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:09:37,008 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:09:37,008 - INFO - Successfully connected to Supabase.
2025-04-10 12:09:37,166 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:09:37,166 - INFO - Migration completed for patient_medications.
2025-04-10 12:09:37,166 - INFO - Starting migration for physician_assignments...
2025-04-10 12:09:37,167 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:09:37,221 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:09:37,221 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:09:37,221 - INFO - Successfully connected to Supabase.
2025-04-10 12:09:37,353 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:09:37,353 - INFO - Migration completed for physician_assignments.
2025-04-10 12:30:47,273 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:30:47,375 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:30:47,380 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:30:53,738 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:30:53,912 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION';
    
2025-04-10 12:30:53,913 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:30:56,274 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:30:56,382 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE  visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-10 12:30:56,385 - INFO - Saved patients by vist date to CSV.
2025-04-10 12:31:00,560 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:00,711 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:31:00,714 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:31:02,792 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:02,912 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:31:02,915 - INFO - Saved visits per month data to CSV.
2025-04-10 12:31:04,618 - INFO - Starting migration for patient_demographics...
2025-04-10 12:31:04,621 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:04,771 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:31:04,771 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:31:04,771 - INFO - Successfully connected to Supabase.
2025-04-10 12:31:04,946 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:31:04,947 - INFO - Migration completed for patient_demographics.
2025-04-10 12:31:04,947 - INFO - Starting migration for patient_visits...
2025-04-10 12:31:04,947 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:05,014 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:31:05,014 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:31:05,015 - INFO - Successfully connected to Supabase.
2025-04-10 12:31:05,153 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:31:05,153 - INFO - Migration completed for patient_visits.
2025-04-10 12:31:05,153 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:31:05,154 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:05,225 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:31:05,225 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:31:05,225 - INFO - Successfully connected to Supabase.
2025-04-10 12:31:05,422 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:31:05,422 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:31:05,422 - INFO - Starting migration for patient_medications...
2025-04-10 12:31:05,423 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:05,484 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:31:05,484 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:31:05,485 - INFO - Successfully connected to Supabase.
2025-04-10 12:31:05,606 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:31:05,606 - INFO - Migration completed for patient_medications.
2025-04-10 12:31:05,606 - INFO - Starting migration for physician_assignments...
2025-04-10 12:31:05,607 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:31:05,668 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:31:05,669 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:31:05,669 - INFO - Successfully connected to Supabase.
2025-04-10 12:31:05,784 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:31:05,784 - INFO - Migration completed for physician_assignments.
2025-04-10 12:44:50,997 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:51,124 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:44:51,131 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:44:54,277 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:54,423 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 12:44:54,429 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:44:54,432 - ERROR - Error getting patients by diagnosis: '>=' not supported between instances of 'datetime.date' and 'str'
2025-04-10 12:44:54,435 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:54,534 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:44:54,535 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:44:56,551 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:56,646 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:44:56,648 - INFO - Saved visits per month data to CSV.
2025-04-10 12:44:58,721 - INFO - Starting migration for patient_demographics...
2025-04-10 12:44:58,721 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:58,899 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:44:58,899 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:44:58,900 - INFO - Successfully connected to Supabase.
2025-04-10 12:44:59,082 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:44:59,082 - INFO - Migration completed for patient_demographics.
2025-04-10 12:44:59,082 - INFO - Starting migration for patient_visits...
2025-04-10 12:44:59,083 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:59,147 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:44:59,147 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:44:59,148 - INFO - Successfully connected to Supabase.
2025-04-10 12:44:59,291 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:44:59,291 - INFO - Migration completed for patient_visits.
2025-04-10 12:44:59,291 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:44:59,292 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:59,460 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:44:59,460 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:44:59,461 - INFO - Successfully connected to Supabase.
2025-04-10 12:44:59,625 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:44:59,625 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:44:59,625 - INFO - Starting migration for patient_medications...
2025-04-10 12:44:59,626 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:59,709 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:44:59,709 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:44:59,710 - INFO - Successfully connected to Supabase.
2025-04-10 12:44:59,848 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:44:59,848 - INFO - Migration completed for patient_medications.
2025-04-10 12:44:59,848 - INFO - Starting migration for physician_assignments...
2025-04-10 12:44:59,849 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:44:59,917 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:44:59,917 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:44:59,917 - INFO - Successfully connected to Supabase.
2025-04-10 12:45:00,049 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:45:00,049 - INFO - Migration completed for physician_assignments.
2025-04-10 12:46:18,854 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:18,952 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:46:18,955 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:46:24,380 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:24,490 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 12:46:24,491 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:46:24,492 - ERROR - Error getting patients by diagnosis: '>=' not supported between instances of 'datetime.date' and 'str'
2025-04-10 12:46:24,493 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:24,602 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:46:24,604 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:46:26,428 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:26,520 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:46:26,521 - INFO - Saved visits per month data to CSV.
2025-04-10 12:46:28,408 - INFO - Starting migration for patient_demographics...
2025-04-10 12:46:28,411 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:28,512 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:46:28,512 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:46:28,513 - INFO - Successfully connected to Supabase.
2025-04-10 12:46:28,686 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:46:28,686 - INFO - Migration completed for patient_demographics.
2025-04-10 12:46:28,686 - INFO - Starting migration for patient_visits...
2025-04-10 12:46:28,687 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:28,765 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:46:28,765 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:46:28,766 - INFO - Successfully connected to Supabase.
2025-04-10 12:46:28,899 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:46:28,899 - INFO - Migration completed for patient_visits.
2025-04-10 12:46:28,899 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:46:28,900 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:28,968 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:46:28,968 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:46:28,969 - INFO - Successfully connected to Supabase.
2025-04-10 12:46:29,127 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:46:29,128 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:46:29,128 - INFO - Starting migration for patient_medications...
2025-04-10 12:46:29,129 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:29,216 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:46:29,216 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:46:29,217 - INFO - Successfully connected to Supabase.
2025-04-10 12:46:29,384 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:46:29,384 - INFO - Migration completed for patient_medications.
2025-04-10 12:46:29,384 - INFO - Starting migration for physician_assignments...
2025-04-10 12:46:29,385 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:46:29,445 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:46:29,445 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:46:29,446 - INFO - Successfully connected to Supabase.
2025-04-10 12:46:29,572 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:46:29,572 - INFO - Migration completed for physician_assignments.
2025-04-10 12:49:00,671 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:00,750 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:49:00,753 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:49:06,335 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:06,439 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 12:49:06,441 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:49:06,442 - ERROR - Error getting patients by diagnosis: '>=' not supported between instances of 'datetime.date' and 'str'
2025-04-10 12:49:06,443 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:06,521 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:49:06,522 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:49:08,480 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:08,571 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:49:08,572 - INFO - Saved visits per month data to CSV.
2025-04-10 12:49:10,498 - INFO - Starting migration for patient_demographics...
2025-04-10 12:49:10,499 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:10,599 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:49:10,599 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:49:10,600 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:10,746 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:49:10,746 - INFO - Migration completed for patient_demographics.
2025-04-10 12:49:10,746 - INFO - Starting migration for patient_visits...
2025-04-10 12:49:10,747 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:10,820 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:49:10,820 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:49:10,820 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:10,951 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:49:10,951 - INFO - Migration completed for patient_visits.
2025-04-10 12:49:10,951 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:49:10,952 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:11,018 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:49:11,018 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:49:11,018 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:11,144 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:49:11,144 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:49:11,144 - INFO - Starting migration for patient_medications...
2025-04-10 12:49:11,145 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:11,207 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:49:11,207 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:49:11,208 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:11,321 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:49:11,321 - INFO - Migration completed for patient_medications.
2025-04-10 12:49:11,321 - INFO - Starting migration for physician_assignments...
2025-04-10 12:49:11,322 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:11,387 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:49:11,388 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:49:11,388 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:11,512 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:49:11,512 - INFO - Migration completed for physician_assignments.
2025-04-10 12:49:50,427 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:50,516 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:49:50,518 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:49:52,809 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:52,983 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 12:49:52,986 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:49:52,987 - ERROR - Error getting patients by diagnosis: '>=' not supported between instances of 'datetime.date' and 'str'
2025-04-10 12:49:52,988 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:53,084 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:49:53,085 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:49:55,181 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:55,287 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:49:55,288 - INFO - Saved visits per month data to CSV.
2025-04-10 12:49:57,100 - INFO - Starting migration for patient_demographics...
2025-04-10 12:49:57,102 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:57,186 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:49:57,186 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:49:57,186 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:57,318 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:49:57,318 - INFO - Migration completed for patient_demographics.
2025-04-10 12:49:57,318 - INFO - Starting migration for patient_visits...
2025-04-10 12:49:57,319 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:57,396 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:49:57,396 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:49:57,397 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:57,546 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:49:57,546 - INFO - Migration completed for patient_visits.
2025-04-10 12:49:57,546 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:49:57,547 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:57,731 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:49:57,731 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:49:57,732 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:57,855 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:49:57,855 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:49:57,856 - INFO - Starting migration for patient_medications...
2025-04-10 12:49:57,857 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:57,925 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:49:57,925 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:49:57,926 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:58,047 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:49:58,047 - INFO - Migration completed for patient_medications.
2025-04-10 12:49:58,047 - INFO - Starting migration for physician_assignments...
2025-04-10 12:49:58,048 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:49:58,109 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:49:58,109 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:49:58,110 - INFO - Successfully connected to Supabase.
2025-04-10 12:49:58,245 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:49:58,245 - INFO - Migration completed for physician_assignments.
2025-04-10 12:51:08,813 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:08,881 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:51:08,883 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:51:10,880 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:11,065 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 12:51:11,067 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:51:11,068 - ERROR - Error getting patients by diagnosis: '>=' not supported between instances of 'datetime.date' and 'str'
2025-04-10 12:51:11,069 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:11,128 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:51:11,129 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:51:12,779 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:12,975 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:51:12,977 - INFO - Saved visits per month data to CSV.
2025-04-10 12:51:15,066 - INFO - Starting migration for patient_demographics...
2025-04-10 12:51:15,067 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:15,162 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:51:15,162 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:51:15,165 - INFO - Successfully connected to Supabase.
2025-04-10 12:51:15,318 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:51:15,319 - INFO - Migration completed for patient_demographics.
2025-04-10 12:51:15,319 - INFO - Starting migration for patient_visits...
2025-04-10 12:51:15,320 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:15,407 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:51:15,407 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:51:15,409 - INFO - Successfully connected to Supabase.
2025-04-10 12:51:15,538 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:51:15,538 - INFO - Migration completed for patient_visits.
2025-04-10 12:51:15,538 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:51:15,539 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:15,606 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:51:15,606 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:51:15,607 - INFO - Successfully connected to Supabase.
2025-04-10 12:51:15,735 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:51:15,735 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:51:15,735 - INFO - Starting migration for patient_medications...
2025-04-10 12:51:15,736 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:15,792 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:51:15,792 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:51:15,793 - INFO - Successfully connected to Supabase.
2025-04-10 12:51:15,929 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:51:15,930 - INFO - Migration completed for patient_medications.
2025-04-10 12:51:15,930 - INFO - Starting migration for physician_assignments...
2025-04-10 12:51:15,931 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:51:16,010 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:51:16,010 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:51:16,011 - INFO - Successfully connected to Supabase.
2025-04-10 12:51:16,151 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:51:16,151 - INFO - Migration completed for physician_assignments.
2025-04-10 12:53:24,359 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:53:24,433 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 12:53:24,436 - INFO - Saved visits per patient data to CSV.
2025-04-10 12:53:26,816 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:53:26,927 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 12:53:26,928 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 12:54:06,420 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:06,526 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 12:54:06,528 - INFO - Saved average visits per patient data to CSV.
2025-04-10 12:54:08,449 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:08,559 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 12:54:08,561 - INFO - Saved visits per month data to CSV.
2025-04-10 12:54:10,731 - INFO - Starting migration for patient_demographics...
2025-04-10 12:54:10,732 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:10,825 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 12:54:10,825 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 12:54:10,826 - INFO - Successfully connected to Supabase.
2025-04-10 12:54:10,974 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 12:54:10,975 - INFO - Migration completed for patient_demographics.
2025-04-10 12:54:10,975 - INFO - Starting migration for patient_visits...
2025-04-10 12:54:10,976 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:11,051 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 12:54:11,051 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 12:54:11,052 - INFO - Successfully connected to Supabase.
2025-04-10 12:54:11,168 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 12:54:11,168 - INFO - Migration completed for patient_visits.
2025-04-10 12:54:11,168 - INFO - Starting migration for patient_lab_results...
2025-04-10 12:54:11,170 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:11,234 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 12:54:11,234 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 12:54:11,235 - INFO - Successfully connected to Supabase.
2025-04-10 12:54:11,370 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 12:54:11,370 - INFO - Migration completed for patient_lab_results.
2025-04-10 12:54:11,371 - INFO - Starting migration for patient_medications...
2025-04-10 12:54:11,371 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:11,428 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 12:54:11,428 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 12:54:11,429 - INFO - Successfully connected to Supabase.
2025-04-10 12:54:11,572 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 12:54:11,572 - INFO - Migration completed for patient_medications.
2025-04-10 12:54:11,572 - INFO - Starting migration for physician_assignments...
2025-04-10 12:54:11,573 - INFO - Successfully connected to PostgreSQL.
2025-04-10 12:54:11,640 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 12:54:11,640 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 12:54:11,640 - INFO - Successfully connected to Supabase.
2025-04-10 12:54:11,814 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 12:54:11,814 - INFO - Migration completed for physician_assignments.
2025-04-10 13:19:47,939 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:19:48,101 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 13:19:48,106 - INFO - Saved visits per patient data to CSV.
2025-04-10 13:19:53,452 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:19:53,570 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 13:19:53,571 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 13:19:57,200 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:19:57,304 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 13:19:57,305 - INFO - Saved average visits per patient data to CSV.
2025-04-10 13:20:14,431 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:20:14,537 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 13:20:14,539 - INFO - Saved visits per month data to CSV.
2025-04-10 13:20:17,027 - INFO - Starting migration for patient_demographics...
2025-04-10 13:20:17,027 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:20:17,117 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 13:20:17,117 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 13:20:17,119 - INFO - Successfully connected to Supabase.
2025-04-10 13:20:17,322 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 13:20:17,323 - INFO - Migration completed for patient_demographics.
2025-04-10 13:20:17,323 - INFO - Starting migration for patient_visits...
2025-04-10 13:20:17,323 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:20:17,392 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 13:20:17,392 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 13:20:17,393 - INFO - Successfully connected to Supabase.
2025-04-10 13:20:17,523 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 13:20:17,523 - INFO - Migration completed for patient_visits.
2025-04-10 13:20:17,523 - INFO - Starting migration for patient_lab_results...
2025-04-10 13:20:17,524 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:20:17,590 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 13:20:17,590 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 13:20:17,591 - INFO - Successfully connected to Supabase.
2025-04-10 13:20:17,717 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 13:20:17,717 - INFO - Migration completed for patient_lab_results.
2025-04-10 13:20:17,718 - INFO - Starting migration for patient_medications...
2025-04-10 13:20:17,718 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:20:17,788 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 13:20:17,788 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 13:20:17,788 - INFO - Successfully connected to Supabase.
2025-04-10 13:20:17,915 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 13:20:17,915 - INFO - Migration completed for patient_medications.
2025-04-10 13:20:17,915 - INFO - Starting migration for physician_assignments...
2025-04-10 13:20:17,916 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:20:17,976 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 13:20:17,976 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 13:20:17,977 - INFO - Successfully connected to Supabase.
2025-04-10 13:20:18,084 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 13:20:18,085 - INFO - Migration completed for physician_assignments.
2025-04-10 13:26:52,509 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:52,579 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 13:26:52,582 - INFO - Saved visits per patient data to CSV.
2025-04-10 13:26:52,859 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:52,927 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 13:26:52,928 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 13:26:53,042 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:53,104 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 13:26:53,105 - INFO - Saved average visits per patient data to CSV.
2025-04-10 13:26:53,307 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:53,370 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 13:26:53,371 - INFO - Saved visits per month data to CSV.
2025-04-10 13:26:53,543 - INFO - Starting migration for patient_demographics...
2025-04-10 13:26:53,544 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:53,606 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 13:26:53,606 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 13:26:53,607 - INFO - Successfully connected to Supabase.
2025-04-10 13:26:53,743 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 13:26:53,743 - INFO - Migration completed for patient_demographics.
2025-04-10 13:26:53,743 - INFO - Starting migration for patient_visits...
2025-04-10 13:26:53,743 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:53,810 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 13:26:53,810 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 13:26:53,810 - INFO - Successfully connected to Supabase.
2025-04-10 13:26:53,939 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 13:26:53,939 - INFO - Migration completed for patient_visits.
2025-04-10 13:26:53,939 - INFO - Starting migration for patient_lab_results...
2025-04-10 13:26:53,939 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:54,001 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 13:26:54,001 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 13:26:54,001 - INFO - Successfully connected to Supabase.
2025-04-10 13:26:54,120 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 13:26:54,121 - INFO - Migration completed for patient_lab_results.
2025-04-10 13:26:54,121 - INFO - Starting migration for patient_medications...
2025-04-10 13:26:54,122 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:54,199 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 13:26:54,199 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 13:26:54,199 - INFO - Successfully connected to Supabase.
2025-04-10 13:26:54,348 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 13:26:54,348 - INFO - Migration completed for patient_medications.
2025-04-10 13:26:54,348 - INFO - Starting migration for physician_assignments...
2025-04-10 13:26:54,349 - INFO - Successfully connected to PostgreSQL.
2025-04-10 13:26:54,517 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 13:26:54,517 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 13:26:54,518 - INFO - Successfully connected to Supabase.
2025-04-10 13:26:54,631 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 13:26:54,631 - INFO - Migration completed for physician_assignments.
2025-04-10 17:36:25,038 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:25,155 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 17:36:25,159 - INFO - Saved visits per patient data to CSV.
2025-04-10 17:36:26,204 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:26,322 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31');;
    
2025-04-10 17:36:26,323 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 17:36:26,469 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:26,539 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 17:36:26,541 - INFO - Saved average visits per patient data to CSV.
2025-04-10 17:36:26,701 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:26,755 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 17:36:26,758 - INFO - Saved visits per month data to CSV.
2025-04-10 17:36:26,905 - INFO - Starting migration for patient_demographics...
2025-04-10 17:36:26,905 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:26,962 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 17:36:26,962 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 17:36:26,963 - INFO - Successfully connected to Supabase.
2025-04-10 17:36:27,136 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 17:36:27,136 - INFO - Migration completed for patient_demographics.
2025-04-10 17:36:27,136 - INFO - Starting migration for patient_visits...
2025-04-10 17:36:27,136 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:27,191 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 17:36:27,191 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 17:36:27,192 - INFO - Successfully connected to Supabase.
2025-04-10 17:36:27,329 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 17:36:27,329 - INFO - Migration completed for patient_visits.
2025-04-10 17:36:27,329 - INFO - Starting migration for patient_lab_results...
2025-04-10 17:36:27,330 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:27,384 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 17:36:27,384 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 17:36:27,385 - INFO - Successfully connected to Supabase.
2025-04-10 17:36:27,492 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 17:36:27,492 - INFO - Migration completed for patient_lab_results.
2025-04-10 17:36:27,492 - INFO - Starting migration for patient_medications...
2025-04-10 17:36:27,492 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:27,549 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 17:36:27,549 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 17:36:27,550 - INFO - Successfully connected to Supabase.
2025-04-10 17:36:27,653 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 17:36:27,653 - INFO - Migration completed for patient_medications.
2025-04-10 17:36:27,653 - INFO - Starting migration for physician_assignments...
2025-04-10 17:36:27,653 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:36:27,700 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 17:36:27,701 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 17:36:27,701 - INFO - Successfully connected to Supabase.
2025-04-10 17:36:27,800 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 17:36:27,800 - INFO - Migration completed for physician_assignments.
2025-04-10 17:52:37,789 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:37,874 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-10 17:52:37,878 - INFO - Saved visits per patient data to CSV.
2025-04-10 17:52:38,195 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:38,265 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-10 17:52:38,266 - INFO - Saved patients by diagnosis to CSV.
2025-04-10 17:52:38,434 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:38,478 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-10 17:52:38,479 - INFO - Saved average visits per patient data to CSV.
2025-04-10 17:52:38,652 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:38,742 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-10 17:52:38,743 - INFO - Saved visits per month data to CSV.
2025-04-10 17:52:38,876 - INFO - Starting migration for patient_demographics...
2025-04-10 17:52:38,877 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:38,929 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-10 17:52:38,930 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-10 17:52:38,930 - INFO - Successfully connected to Supabase.
2025-04-10 17:52:39,065 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-10 17:52:39,066 - INFO - Migration completed for patient_demographics.
2025-04-10 17:52:39,066 - INFO - Starting migration for patient_visits...
2025-04-10 17:52:39,067 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:39,149 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-10 17:52:39,149 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-10 17:52:39,150 - INFO - Successfully connected to Supabase.
2025-04-10 17:52:39,288 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-10 17:52:39,288 - INFO - Migration completed for patient_visits.
2025-04-10 17:52:39,288 - INFO - Starting migration for patient_lab_results...
2025-04-10 17:52:39,289 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:39,358 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-10 17:52:39,358 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-10 17:52:39,359 - INFO - Successfully connected to Supabase.
2025-04-10 17:52:39,466 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-10 17:52:39,466 - INFO - Migration completed for patient_lab_results.
2025-04-10 17:52:39,466 - INFO - Starting migration for patient_medications...
2025-04-10 17:52:39,467 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:39,514 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-10 17:52:39,514 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-10 17:52:39,514 - INFO - Successfully connected to Supabase.
2025-04-10 17:52:39,639 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-10 17:52:39,639 - INFO - Migration completed for patient_medications.
2025-04-10 17:52:39,639 - INFO - Starting migration for physician_assignments...
2025-04-10 17:52:39,640 - INFO - Successfully connected to PostgreSQL.
2025-04-10 17:52:39,687 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-10 17:52:39,687 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-10 17:52:39,688 - INFO - Successfully connected to Supabase.
2025-04-10 17:52:39,773 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-10 17:52:39,773 - INFO - Migration completed for physician_assignments.
2025-04-11 09:26:09,435 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:09,523 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 09:26:09,527 - INFO - Saved visits per patient data to CSV.
2025-04-11 09:26:10,829 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:10,888 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 09:26:10,889 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 09:26:10,991 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:11,039 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 09:26:11,040 - INFO - Saved average visits per patient data to CSV.
2025-04-11 09:26:11,211 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:11,260 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 09:26:11,261 - INFO - Saved visits per month data to CSV.
2025-04-11 09:26:11,432 - INFO - Starting migration for patient_demographics...
2025-04-11 09:26:11,432 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:11,508 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 09:26:11,508 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 09:26:11,508 - INFO - Successfully connected to Supabase.
2025-04-11 09:26:11,615 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 09:26:11,615 - INFO - Migration completed for patient_demographics.
2025-04-11 09:26:11,615 - INFO - Starting migration for patient_visits...
2025-04-11 09:26:11,616 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:11,666 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 09:26:11,666 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 09:26:11,667 - INFO - Successfully connected to Supabase.
2025-04-11 09:26:11,780 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 09:26:11,780 - INFO - Migration completed for patient_visits.
2025-04-11 09:26:11,780 - INFO - Starting migration for patient_lab_results...
2025-04-11 09:26:11,780 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:11,831 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 09:26:11,831 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 09:26:11,832 - INFO - Successfully connected to Supabase.
2025-04-11 09:26:11,925 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 09:26:11,925 - INFO - Migration completed for patient_lab_results.
2025-04-11 09:26:11,925 - INFO - Starting migration for patient_medications...
2025-04-11 09:26:11,926 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:11,993 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 09:26:11,994 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 09:26:11,994 - INFO - Successfully connected to Supabase.
2025-04-11 09:26:12,089 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 09:26:12,090 - INFO - Migration completed for patient_medications.
2025-04-11 09:26:12,090 - INFO - Starting migration for physician_assignments...
2025-04-11 09:26:12,090 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:26:12,146 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 09:26:12,146 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 09:26:12,147 - INFO - Successfully connected to Supabase.
2025-04-11 09:26:12,246 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 09:26:12,246 - INFO - Migration completed for physician_assignments.
2025-04-11 09:44:56,285 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:56,378 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 09:44:56,386 - INFO - Saved visits per patient data to CSV.
2025-04-11 09:44:56,877 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:56,928 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 09:44:56,929 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 09:44:57,020 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:57,067 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 09:44:57,068 - INFO - Saved average visits per patient data to CSV.
2025-04-11 09:44:57,220 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:57,268 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 09:44:57,269 - INFO - Saved visits per month data to CSV.
2025-04-11 09:44:57,387 - INFO - Starting migration for patient_demographics...
2025-04-11 09:44:57,387 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:57,434 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 09:44:57,434 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 09:44:57,434 - INFO - Successfully connected to Supabase.
2025-04-11 09:44:57,534 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 09:44:57,534 - INFO - Migration completed for patient_demographics.
2025-04-11 09:44:57,534 - INFO - Starting migration for patient_visits...
2025-04-11 09:44:57,535 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:57,594 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 09:44:57,594 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 09:44:57,594 - INFO - Successfully connected to Supabase.
2025-04-11 09:44:57,702 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 09:44:57,702 - INFO - Migration completed for patient_visits.
2025-04-11 09:44:57,702 - INFO - Starting migration for patient_lab_results...
2025-04-11 09:44:57,703 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:57,763 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 09:44:57,763 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 09:44:57,763 - INFO - Successfully connected to Supabase.
2025-04-11 09:44:57,866 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 09:44:57,866 - INFO - Migration completed for patient_lab_results.
2025-04-11 09:44:57,866 - INFO - Starting migration for patient_medications...
2025-04-11 09:44:57,867 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:57,930 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 09:44:57,930 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 09:44:57,930 - INFO - Successfully connected to Supabase.
2025-04-11 09:44:58,055 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 09:44:58,056 - INFO - Migration completed for patient_medications.
2025-04-11 09:44:58,056 - INFO - Starting migration for physician_assignments...
2025-04-11 09:44:58,056 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:44:58,106 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 09:44:58,106 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 09:44:58,106 - INFO - Successfully connected to Supabase.
2025-04-11 09:44:58,226 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 09:44:58,226 - INFO - Migration completed for physician_assignments.
2025-04-11 09:45:21,602 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:21,708 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 09:45:21,711 - INFO - Saved visits per patient data to CSV.
2025-04-11 09:45:22,006 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:22,055 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 09:45:22,056 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 09:45:22,201 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:22,262 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 09:45:22,263 - INFO - Saved average visits per patient data to CSV.
2025-04-11 09:45:22,491 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:22,538 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 09:45:22,539 - INFO - Saved visits per month data to CSV.
2025-04-11 09:45:22,702 - INFO - Starting migration for patient_demographics...
2025-04-11 09:45:22,702 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:22,751 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 09:45:22,751 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 09:45:22,751 - INFO - Successfully connected to Supabase.
2025-04-11 09:45:22,850 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 09:45:22,850 - INFO - Migration completed for patient_demographics.
2025-04-11 09:45:22,850 - INFO - Starting migration for patient_visits...
2025-04-11 09:45:22,850 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:22,911 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 09:45:22,911 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 09:45:22,912 - INFO - Successfully connected to Supabase.
2025-04-11 09:45:23,007 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 09:45:23,007 - INFO - Migration completed for patient_visits.
2025-04-11 09:45:23,007 - INFO - Starting migration for patient_lab_results...
2025-04-11 09:45:23,007 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:23,051 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 09:45:23,051 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 09:45:23,051 - INFO - Successfully connected to Supabase.
2025-04-11 09:45:23,178 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 09:45:23,179 - INFO - Migration completed for patient_lab_results.
2025-04-11 09:45:23,179 - INFO - Starting migration for patient_medications...
2025-04-11 09:45:23,179 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:23,249 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 09:45:23,249 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 09:45:23,250 - INFO - Successfully connected to Supabase.
2025-04-11 09:45:23,388 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 09:45:23,389 - INFO - Migration completed for patient_medications.
2025-04-11 09:45:23,389 - INFO - Starting migration for physician_assignments...
2025-04-11 09:45:23,390 - INFO - Successfully connected to PostgreSQL.
2025-04-11 09:45:23,560 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 09:45:23,560 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 09:45:23,561 - INFO - Successfully connected to Supabase.
2025-04-11 09:45:23,675 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 09:45:23,676 - INFO - Migration completed for physician_assignments.
2025-04-11 10:00:04,636 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:04,805 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 10:00:04,814 - INFO - Saved visits per patient data to CSV.
2025-04-11 10:00:05,317 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:05,468 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 10:00:05,469 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 10:00:05,563 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:05,610 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 10:00:05,611 - INFO - Saved average visits per patient data to CSV.
2025-04-11 10:00:05,778 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:05,823 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 10:00:05,824 - INFO - Saved visits per month data to CSV.
2025-04-11 10:00:05,942 - INFO - Starting migration for patient_demographics...
2025-04-11 10:00:05,943 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:05,997 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 10:00:05,997 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 10:00:05,997 - INFO - Successfully connected to Supabase.
2025-04-11 10:00:06,169 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 10:00:06,169 - INFO - Migration completed for patient_demographics.
2025-04-11 10:00:06,170 - INFO - Starting migration for patient_visits...
2025-04-11 10:00:06,170 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:06,248 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 10:00:06,248 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 10:00:06,249 - INFO - Successfully connected to Supabase.
2025-04-11 10:00:06,372 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 10:00:06,372 - INFO - Migration completed for patient_visits.
2025-04-11 10:00:06,372 - INFO - Starting migration for patient_lab_results...
2025-04-11 10:00:06,372 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:06,439 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 10:00:06,439 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 10:00:06,440 - INFO - Successfully connected to Supabase.
2025-04-11 10:00:06,545 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 10:00:06,545 - INFO - Migration completed for patient_lab_results.
2025-04-11 10:00:06,545 - INFO - Starting migration for patient_medications...
2025-04-11 10:00:06,546 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:06,702 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 10:00:06,702 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 10:00:06,703 - INFO - Successfully connected to Supabase.
2025-04-11 10:00:06,789 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 10:00:06,789 - INFO - Migration completed for patient_medications.
2025-04-11 10:00:06,789 - INFO - Starting migration for physician_assignments...
2025-04-11 10:00:06,790 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:00:06,939 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 10:00:06,939 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 10:00:06,940 - INFO - Successfully connected to Supabase.
2025-04-11 10:00:07,025 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 10:00:07,025 - INFO - Migration completed for physician_assignments.
2025-04-11 10:06:46,019 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:46,088 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 10:06:46,091 - INFO - Saved visits per patient data to CSV.
2025-04-11 10:06:46,342 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:46,390 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 10:06:46,391 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 10:06:46,480 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:46,527 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 10:06:46,528 - INFO - Saved average visits per patient data to CSV.
2025-04-11 10:06:46,674 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:46,723 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 10:06:46,724 - INFO - Saved visits per month data to CSV.
2025-04-11 10:06:46,835 - INFO - Starting migration for patient_demographics...
2025-04-11 10:06:46,836 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:46,881 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 10:06:46,881 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 10:06:46,881 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:46,965 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 10:06:46,965 - INFO - Migration completed for patient_demographics.
2025-04-11 10:06:46,965 - INFO - Starting migration for patient_visits...
2025-04-11 10:06:46,966 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:47,019 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 10:06:47,019 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 10:06:47,020 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:47,102 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 10:06:47,102 - INFO - Migration completed for patient_visits.
2025-04-11 10:06:47,102 - INFO - Starting migration for patient_lab_results...
2025-04-11 10:06:47,103 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:47,149 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 10:06:47,149 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 10:06:47,149 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:47,277 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 10:06:47,277 - INFO - Migration completed for patient_lab_results.
2025-04-11 10:06:47,277 - INFO - Starting migration for patient_medications...
2025-04-11 10:06:47,278 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:47,330 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 10:06:47,330 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 10:06:47,331 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:47,427 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 10:06:47,427 - INFO - Migration completed for patient_medications.
2025-04-11 10:06:47,427 - INFO - Starting migration for physician_assignments...
2025-04-11 10:06:47,428 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:47,487 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 10:06:47,487 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 10:06:47,488 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:47,578 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 10:06:47,579 - INFO - Migration completed for physician_assignments.
2025-04-11 10:06:53,099 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:53,167 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 10:06:53,168 - INFO - Saved visits per patient data to CSV.
2025-04-11 10:06:53,338 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:53,383 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 10:06:53,384 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 10:06:53,468 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:53,512 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 10:06:53,513 - INFO - Saved average visits per patient data to CSV.
2025-04-11 10:06:53,659 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:53,711 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 10:06:53,715 - INFO - Saved visits per month data to CSV.
2025-04-11 10:06:53,842 - INFO - Starting migration for patient_demographics...
2025-04-11 10:06:53,843 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:53,890 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 10:06:53,890 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 10:06:53,890 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:53,984 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 10:06:53,984 - INFO - Migration completed for patient_demographics.
2025-04-11 10:06:53,984 - INFO - Starting migration for patient_visits...
2025-04-11 10:06:53,985 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:54,046 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 10:06:54,046 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 10:06:54,047 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:54,158 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 10:06:54,158 - INFO - Migration completed for patient_visits.
2025-04-11 10:06:54,158 - INFO - Starting migration for patient_lab_results...
2025-04-11 10:06:54,159 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:54,207 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 10:06:54,207 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 10:06:54,208 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:54,332 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 10:06:54,332 - INFO - Migration completed for patient_lab_results.
2025-04-11 10:06:54,332 - INFO - Starting migration for patient_medications...
2025-04-11 10:06:54,333 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:54,516 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 10:06:54,516 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 10:06:54,517 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:54,638 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 10:06:54,638 - INFO - Migration completed for patient_medications.
2025-04-11 10:06:54,638 - INFO - Starting migration for physician_assignments...
2025-04-11 10:06:54,638 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:06:54,688 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 10:06:54,688 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 10:06:54,688 - INFO - Successfully connected to Supabase.
2025-04-11 10:06:54,801 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 10:06:54,801 - INFO - Migration completed for physician_assignments.
2025-04-11 10:15:34,613 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:34,675 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 10:15:34,677 - INFO - Saved visits per patient data to CSV.
2025-04-11 10:15:34,864 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:34,908 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 10:15:34,909 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 10:15:34,994 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:35,041 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 10:15:35,042 - INFO - Saved average visits per patient data to CSV.
2025-04-11 10:15:35,188 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:35,234 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 10:15:35,235 - INFO - Saved visits per month data to CSV.
2025-04-11 10:15:35,362 - INFO - Starting migration for patient_demographics...
2025-04-11 10:15:35,363 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:35,410 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 10:15:35,410 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 10:15:35,410 - INFO - Successfully connected to Supabase.
2025-04-11 10:15:35,504 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 10:15:35,504 - INFO - Migration completed for patient_demographics.
2025-04-11 10:15:35,504 - INFO - Starting migration for patient_visits...
2025-04-11 10:15:35,505 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:35,555 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 10:15:35,555 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 10:15:35,556 - INFO - Successfully connected to Supabase.
2025-04-11 10:15:35,668 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 10:15:35,668 - INFO - Migration completed for patient_visits.
2025-04-11 10:15:35,668 - INFO - Starting migration for patient_lab_results...
2025-04-11 10:15:35,669 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:35,724 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 10:15:35,724 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 10:15:35,725 - INFO - Successfully connected to Supabase.
2025-04-11 10:15:35,839 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 10:15:35,839 - INFO - Migration completed for patient_lab_results.
2025-04-11 10:15:35,839 - INFO - Starting migration for patient_medications...
2025-04-11 10:15:35,840 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:36,004 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 10:15:36,004 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 10:15:36,004 - INFO - Successfully connected to Supabase.
2025-04-11 10:15:36,086 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 10:15:36,086 - INFO - Migration completed for patient_medications.
2025-04-11 10:15:36,086 - INFO - Starting migration for physician_assignments...
2025-04-11 10:15:36,087 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:15:36,127 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 10:15:36,127 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 10:15:36,128 - INFO - Successfully connected to Supabase.
2025-04-11 10:15:36,207 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 10:15:36,207 - INFO - Migration completed for physician_assignments.
2025-04-11 10:20:44,994 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:45,052 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 10:20:45,055 - INFO - Saved visits per patient data to CSV.
2025-04-11 10:20:45,258 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:45,302 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 10:20:45,303 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 10:20:45,391 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:45,448 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 10:20:45,449 - INFO - Saved average visits per patient data to CSV.
2025-04-11 10:20:45,638 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:45,684 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 10:20:45,684 - INFO - Saved visits per month data to CSV.
2025-04-11 10:20:45,799 - INFO - Starting migration for patient_demographics...
2025-04-11 10:20:45,800 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:45,840 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 10:20:45,840 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 10:20:45,841 - INFO - Successfully connected to Supabase.
2025-04-11 10:20:45,926 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 10:20:45,926 - INFO - Migration completed for patient_demographics.
2025-04-11 10:20:45,926 - INFO - Starting migration for patient_visits...
2025-04-11 10:20:45,927 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:45,981 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 10:20:45,981 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 10:20:45,982 - INFO - Successfully connected to Supabase.
2025-04-11 10:20:46,076 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 10:20:46,076 - INFO - Migration completed for patient_visits.
2025-04-11 10:20:46,076 - INFO - Starting migration for patient_lab_results...
2025-04-11 10:20:46,077 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:46,119 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 10:20:46,120 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 10:20:46,120 - INFO - Successfully connected to Supabase.
2025-04-11 10:20:46,219 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 10:20:46,219 - INFO - Migration completed for patient_lab_results.
2025-04-11 10:20:46,219 - INFO - Starting migration for patient_medications...
2025-04-11 10:20:46,220 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:46,261 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 10:20:46,261 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 10:20:46,262 - INFO - Successfully connected to Supabase.
2025-04-11 10:20:46,362 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 10:20:46,362 - INFO - Migration completed for patient_medications.
2025-04-11 10:20:46,362 - INFO - Starting migration for physician_assignments...
2025-04-11 10:20:46,362 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:20:46,413 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 10:20:46,413 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 10:20:46,413 - INFO - Successfully connected to Supabase.
2025-04-11 10:20:46,498 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 10:20:46,498 - INFO - Migration completed for physician_assignments.
2025-04-11 10:24:02,988 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:03,061 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 10:24:03,064 - INFO - Saved visits per patient data to CSV.
2025-04-11 10:24:03,310 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:03,361 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 10:24:03,363 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 10:24:03,453 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:03,500 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 10:24:03,501 - INFO - Saved average visits per patient data to CSV.
2025-04-11 10:24:03,660 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:03,709 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 10:24:03,710 - INFO - Saved visits per month data to CSV.
2025-04-11 10:24:03,825 - INFO - Starting migration for patient_demographics...
2025-04-11 10:24:03,826 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:03,873 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 10:24:03,873 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 10:24:03,874 - INFO - Successfully connected to Supabase.
2025-04-11 10:24:03,970 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 10:24:03,971 - INFO - Migration completed for patient_demographics.
2025-04-11 10:24:03,971 - INFO - Starting migration for patient_visits...
2025-04-11 10:24:03,972 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:04,026 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 10:24:04,027 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 10:24:04,027 - INFO - Successfully connected to Supabase.
2025-04-11 10:24:04,112 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 10:24:04,112 - INFO - Migration completed for patient_visits.
2025-04-11 10:24:04,112 - INFO - Starting migration for patient_lab_results...
2025-04-11 10:24:04,113 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:04,162 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 10:24:04,162 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 10:24:04,163 - INFO - Successfully connected to Supabase.
2025-04-11 10:24:04,261 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 10:24:04,261 - INFO - Migration completed for patient_lab_results.
2025-04-11 10:24:04,261 - INFO - Starting migration for patient_medications...
2025-04-11 10:24:04,262 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:04,306 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 10:24:04,306 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 10:24:04,307 - INFO - Successfully connected to Supabase.
2025-04-11 10:24:04,423 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 10:24:04,423 - INFO - Migration completed for patient_medications.
2025-04-11 10:24:04,423 - INFO - Starting migration for physician_assignments...
2025-04-11 10:24:04,423 - INFO - Successfully connected to PostgreSQL.
2025-04-11 10:24:04,483 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 10:24:04,483 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 10:24:04,483 - INFO - Successfully connected to Supabase.
2025-04-11 10:24:04,552 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 10:24:04,553 - INFO - Migration completed for physician_assignments.
2025-04-11 12:56:22,710 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:22,768 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 12:56:22,771 - INFO - Saved visits per patient data to CSV.
2025-04-11 12:56:23,611 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:23,676 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 12:56:23,677 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 12:56:23,804 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:23,862 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 12:56:23,863 - INFO - Saved average visits per patient data to CSV.
2025-04-11 12:56:24,015 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:24,067 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 12:56:24,068 - INFO - Saved visits per month data to CSV.
2025-04-11 12:56:24,181 - INFO - Starting migration for patient_demographics...
2025-04-11 12:56:24,181 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:24,228 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 12:56:24,228 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 12:56:24,229 - INFO - Successfully connected to Supabase.
2025-04-11 12:56:24,319 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 12:56:24,319 - INFO - Migration completed for patient_demographics.
2025-04-11 12:56:24,319 - INFO - Starting migration for patient_visits...
2025-04-11 12:56:24,320 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:24,374 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 12:56:24,374 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 12:56:24,375 - INFO - Successfully connected to Supabase.
2025-04-11 12:56:24,504 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 12:56:24,504 - INFO - Migration completed for patient_visits.
2025-04-11 12:56:24,504 - INFO - Starting migration for patient_lab_results...
2025-04-11 12:56:24,504 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:24,555 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 12:56:24,555 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 12:56:24,556 - INFO - Successfully connected to Supabase.
2025-04-11 12:56:24,657 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 12:56:24,657 - INFO - Migration completed for patient_lab_results.
2025-04-11 12:56:24,657 - INFO - Starting migration for patient_medications...
2025-04-11 12:56:24,658 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:24,704 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 12:56:24,704 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 12:56:24,705 - INFO - Successfully connected to Supabase.
2025-04-11 12:56:24,797 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 12:56:24,797 - INFO - Migration completed for patient_medications.
2025-04-11 12:56:24,797 - INFO - Starting migration for physician_assignments...
2025-04-11 12:56:24,798 - INFO - Successfully connected to PostgreSQL.
2025-04-11 12:56:24,854 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 12:56:24,854 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 12:56:24,855 - INFO - Successfully connected to Supabase.
2025-04-11 12:56:24,939 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 12:56:24,939 - INFO - Migration completed for physician_assignments.
2025-04-11 17:30:04,082 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:04,182 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-11 17:30:04,184 - INFO - Saved visits per patient data to CSV.
2025-04-11 17:30:04,484 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:04,537 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-11 17:30:04,539 - INFO - Saved patients by diagnosis to CSV.
2025-04-11 17:30:04,634 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:04,681 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-11 17:30:04,682 - INFO - Saved average visits per patient data to CSV.
2025-04-11 17:30:04,832 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:04,878 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-11 17:30:04,879 - INFO - Saved visits per month data to CSV.
2025-04-11 17:30:05,003 - INFO - Starting migration for patient_demographics...
2025-04-11 17:30:05,003 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:05,048 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-11 17:30:05,048 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-11 17:30:05,049 - INFO - Successfully connected to Supabase.
2025-04-11 17:30:05,231 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-11 17:30:05,231 - INFO - Migration completed for patient_demographics.
2025-04-11 17:30:05,232 - INFO - Starting migration for patient_visits...
2025-04-11 17:30:05,234 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:05,293 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-11 17:30:05,293 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-11 17:30:05,294 - INFO - Successfully connected to Supabase.
2025-04-11 17:30:05,397 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-11 17:30:05,398 - INFO - Migration completed for patient_visits.
2025-04-11 17:30:05,398 - INFO - Starting migration for patient_lab_results...
2025-04-11 17:30:05,403 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:05,496 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-11 17:30:05,496 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-11 17:30:05,497 - INFO - Successfully connected to Supabase.
2025-04-11 17:30:05,615 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-11 17:30:05,615 - INFO - Migration completed for patient_lab_results.
2025-04-11 17:30:05,615 - INFO - Starting migration for patient_medications...
2025-04-11 17:30:05,616 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:05,673 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-11 17:30:05,673 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-11 17:30:05,674 - INFO - Successfully connected to Supabase.
2025-04-11 17:30:05,794 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-11 17:30:05,795 - INFO - Migration completed for patient_medications.
2025-04-11 17:30:05,795 - INFO - Starting migration for physician_assignments...
2025-04-11 17:30:05,795 - INFO - Successfully connected to PostgreSQL.
2025-04-11 17:30:05,844 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-11 17:30:05,844 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-11 17:30:05,844 - INFO - Successfully connected to Supabase.
2025-04-11 17:30:05,925 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-11 17:30:05,926 - INFO - Migration completed for physician_assignments.
2025-04-12 08:14:10,704 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:10,874 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 08:14:10,876 - INFO - Saved visits per patient data to CSV.
2025-04-12 08:14:11,796 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:11,847 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 08:14:11,848 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 08:14:11,944 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:11,988 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 08:14:11,989 - INFO - Saved average visits per patient data to CSV.
2025-04-12 08:14:12,136 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:12,180 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 08:14:12,181 - INFO - Saved visits per month data to CSV.
2025-04-12 08:14:12,292 - INFO - Starting migration for patient_demographics...
2025-04-12 08:14:12,293 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:12,335 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 08:14:12,335 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 08:14:12,336 - INFO - Successfully connected to Supabase.
2025-04-12 08:14:12,438 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 08:14:12,438 - INFO - Migration completed for patient_demographics.
2025-04-12 08:14:12,438 - INFO - Starting migration for patient_visits...
2025-04-12 08:14:12,439 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:12,493 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 08:14:12,493 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 08:14:12,494 - INFO - Successfully connected to Supabase.
2025-04-12 08:14:12,596 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 08:14:12,596 - INFO - Migration completed for patient_visits.
2025-04-12 08:14:12,596 - INFO - Starting migration for patient_lab_results...
2025-04-12 08:14:12,597 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:12,646 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 08:14:12,646 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 08:14:12,647 - INFO - Successfully connected to Supabase.
2025-04-12 08:14:12,774 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 08:14:12,774 - INFO - Migration completed for patient_lab_results.
2025-04-12 08:14:12,774 - INFO - Starting migration for patient_medications...
2025-04-12 08:14:12,774 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:12,817 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 08:14:12,818 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 08:14:12,818 - INFO - Successfully connected to Supabase.
2025-04-12 08:14:12,922 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 08:14:12,922 - INFO - Migration completed for patient_medications.
2025-04-12 08:14:12,922 - INFO - Starting migration for physician_assignments...
2025-04-12 08:14:12,923 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:12,978 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 08:14:12,978 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 08:14:12,978 - INFO - Successfully connected to Supabase.
2025-04-12 08:14:13,061 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 08:14:13,061 - INFO - Migration completed for physician_assignments.
2025-04-12 08:14:58,808 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:58,903 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 08:14:58,906 - INFO - Saved visits per patient data to CSV.
2025-04-12 08:14:59,239 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:59,286 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 08:14:59,287 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 08:14:59,382 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:59,424 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 08:14:59,425 - INFO - Saved average visits per patient data to CSV.
2025-04-12 08:14:59,581 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:59,630 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 08:14:59,631 - INFO - Saved visits per month data to CSV.
2025-04-12 08:14:59,747 - INFO - Starting migration for patient_demographics...
2025-04-12 08:14:59,748 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:59,798 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 08:14:59,798 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 08:14:59,799 - INFO - Successfully connected to Supabase.
2025-04-12 08:14:59,890 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 08:14:59,890 - INFO - Migration completed for patient_demographics.
2025-04-12 08:14:59,890 - INFO - Starting migration for patient_visits...
2025-04-12 08:14:59,891 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:14:59,954 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 08:14:59,954 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 08:14:59,955 - INFO - Successfully connected to Supabase.
2025-04-12 08:15:00,046 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 08:15:00,046 - INFO - Migration completed for patient_visits.
2025-04-12 08:15:00,046 - INFO - Starting migration for patient_lab_results...
2025-04-12 08:15:00,046 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:15:00,087 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 08:15:00,087 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 08:15:00,088 - INFO - Successfully connected to Supabase.
2025-04-12 08:15:00,171 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 08:15:00,171 - INFO - Migration completed for patient_lab_results.
2025-04-12 08:15:00,171 - INFO - Starting migration for patient_medications...
2025-04-12 08:15:00,172 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:15:00,219 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 08:15:00,219 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 08:15:00,220 - INFO - Successfully connected to Supabase.
2025-04-12 08:15:00,310 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 08:15:00,310 - INFO - Migration completed for patient_medications.
2025-04-12 08:15:00,310 - INFO - Starting migration for physician_assignments...
2025-04-12 08:15:00,311 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:15:00,364 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 08:15:00,364 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 08:15:00,364 - INFO - Successfully connected to Supabase.
2025-04-12 08:15:00,453 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 08:15:00,453 - INFO - Migration completed for physician_assignments.
2025-04-12 08:16:31,028 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:31,084 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 08:16:31,086 - INFO - Saved visits per patient data to CSV.
2025-04-12 08:16:31,264 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:31,305 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 08:16:31,306 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 08:16:31,391 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:31,436 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 08:16:31,437 - INFO - Saved average visits per patient data to CSV.
2025-04-12 08:16:31,580 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:31,631 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 08:16:31,632 - INFO - Saved visits per month data to CSV.
2025-04-12 08:16:31,746 - INFO - Starting migration for patient_demographics...
2025-04-12 08:16:31,747 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:31,794 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 08:16:31,794 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 08:16:31,795 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:31,877 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 08:16:31,877 - INFO - Migration completed for patient_demographics.
2025-04-12 08:16:31,877 - INFO - Starting migration for patient_visits...
2025-04-12 08:16:31,877 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:31,937 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 08:16:31,937 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 08:16:31,938 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:32,032 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 08:16:32,032 - INFO - Migration completed for patient_visits.
2025-04-12 08:16:32,032 - INFO - Starting migration for patient_lab_results...
2025-04-12 08:16:32,033 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:32,077 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 08:16:32,077 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 08:16:32,077 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:32,170 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 08:16:32,170 - INFO - Migration completed for patient_lab_results.
2025-04-12 08:16:32,170 - INFO - Starting migration for patient_medications...
2025-04-12 08:16:32,171 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:32,216 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 08:16:32,216 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 08:16:32,217 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:32,315 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 08:16:32,316 - INFO - Migration completed for patient_medications.
2025-04-12 08:16:32,316 - INFO - Starting migration for physician_assignments...
2025-04-12 08:16:32,316 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:32,370 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 08:16:32,371 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 08:16:32,371 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:32,442 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 08:16:32,442 - INFO - Migration completed for physician_assignments.
2025-04-12 08:16:50,634 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:50,686 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 08:16:50,688 - INFO - Saved visits per patient data to CSV.
2025-04-12 08:16:50,881 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:50,927 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 08:16:50,928 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 08:16:51,014 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,059 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 08:16:51,060 - INFO - Saved average visits per patient data to CSV.
2025-04-12 08:16:51,212 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,259 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 08:16:51,259 - INFO - Saved visits per month data to CSV.
2025-04-12 08:16:51,375 - INFO - Starting migration for patient_demographics...
2025-04-12 08:16:51,375 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,421 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 08:16:51,421 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 08:16:51,422 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:51,522 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 08:16:51,522 - INFO - Migration completed for patient_demographics.
2025-04-12 08:16:51,523 - INFO - Starting migration for patient_visits...
2025-04-12 08:16:51,523 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,580 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 08:16:51,581 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 08:16:51,581 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:51,668 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 08:16:51,668 - INFO - Migration completed for patient_visits.
2025-04-12 08:16:51,668 - INFO - Starting migration for patient_lab_results...
2025-04-12 08:16:51,668 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,712 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 08:16:51,712 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 08:16:51,713 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:51,793 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 08:16:51,793 - INFO - Migration completed for patient_lab_results.
2025-04-12 08:16:51,793 - INFO - Starting migration for patient_medications...
2025-04-12 08:16:51,794 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,836 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 08:16:51,836 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 08:16:51,837 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:51,943 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 08:16:51,943 - INFO - Migration completed for patient_medications.
2025-04-12 08:16:51,943 - INFO - Starting migration for physician_assignments...
2025-04-12 08:16:51,944 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:16:51,999 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 08:16:51,999 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 08:16:52,000 - INFO - Successfully connected to Supabase.
2025-04-12 08:16:52,083 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 08:16:52,083 - INFO - Migration completed for physician_assignments.
2025-04-12 08:18:55,220 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:55,275 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 08:18:55,278 - INFO - Saved visits per patient data to CSV.
2025-04-12 08:18:55,489 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:55,539 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 08:18:55,540 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 08:18:55,652 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:55,709 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 08:18:55,710 - INFO - Saved average visits per patient data to CSV.
2025-04-12 08:18:56,068 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:56,236 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 08:18:56,237 - INFO - Saved visits per month data to CSV.
2025-04-12 08:18:56,384 - INFO - Starting migration for patient_demographics...
2025-04-12 08:18:56,384 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:56,460 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 08:18:56,460 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 08:18:56,461 - INFO - Successfully connected to Supabase.
2025-04-12 08:18:56,574 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 08:18:56,574 - INFO - Migration completed for patient_demographics.
2025-04-12 08:18:56,574 - INFO - Starting migration for patient_visits...
2025-04-12 08:18:56,575 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:56,650 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 08:18:56,650 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 08:18:56,651 - INFO - Successfully connected to Supabase.
2025-04-12 08:18:56,762 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 08:18:56,762 - INFO - Migration completed for patient_visits.
2025-04-12 08:18:56,762 - INFO - Starting migration for patient_lab_results...
2025-04-12 08:18:56,763 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:56,820 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 08:18:56,820 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 08:18:56,821 - INFO - Successfully connected to Supabase.
2025-04-12 08:18:56,933 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 08:18:56,933 - INFO - Migration completed for patient_lab_results.
2025-04-12 08:18:56,933 - INFO - Starting migration for patient_medications...
2025-04-12 08:18:56,934 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:56,987 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 08:18:56,987 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 08:18:56,988 - INFO - Successfully connected to Supabase.
2025-04-12 08:18:57,113 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 08:18:57,113 - INFO - Migration completed for patient_medications.
2025-04-12 08:18:57,113 - INFO - Starting migration for physician_assignments...
2025-04-12 08:18:57,114 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:18:57,171 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 08:18:57,171 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 08:18:57,172 - INFO - Successfully connected to Supabase.
2025-04-12 08:18:57,268 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 08:18:57,269 - INFO - Migration completed for physician_assignments.
2025-04-12 08:20:19,967 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:20,171 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 08:20:20,174 - INFO - Saved visits per patient data to CSV.
2025-04-12 08:20:22,021 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:22,081 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 08:20:22,083 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 08:20:22,253 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:22,311 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 08:20:22,312 - INFO - Saved average visits per patient data to CSV.
2025-04-12 08:20:22,494 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:22,550 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 08:20:22,551 - INFO - Saved visits per month data to CSV.
2025-04-12 08:20:22,729 - INFO - Starting migration for patient_demographics...
2025-04-12 08:20:22,730 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:22,792 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 08:20:22,792 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 08:20:22,793 - INFO - Successfully connected to Supabase.
2025-04-12 08:20:22,907 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 08:20:22,907 - INFO - Migration completed for patient_demographics.
2025-04-12 08:20:22,907 - INFO - Starting migration for patient_visits...
2025-04-12 08:20:22,907 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:22,985 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 08:20:22,985 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 08:20:22,986 - INFO - Successfully connected to Supabase.
2025-04-12 08:20:23,132 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 08:20:23,133 - INFO - Migration completed for patient_visits.
2025-04-12 08:20:23,133 - INFO - Starting migration for patient_lab_results...
2025-04-12 08:20:23,134 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:23,295 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 08:20:23,295 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 08:20:23,296 - INFO - Successfully connected to Supabase.
2025-04-12 08:20:23,385 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 08:20:23,385 - INFO - Migration completed for patient_lab_results.
2025-04-12 08:20:23,385 - INFO - Starting migration for patient_medications...
2025-04-12 08:20:23,385 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:23,442 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 08:20:23,443 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 08:20:23,443 - INFO - Successfully connected to Supabase.
2025-04-12 08:20:23,541 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 08:20:23,541 - INFO - Migration completed for patient_medications.
2025-04-12 08:20:23,541 - INFO - Starting migration for physician_assignments...
2025-04-12 08:20:23,542 - INFO - Successfully connected to PostgreSQL.
2025-04-12 08:20:23,591 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 08:20:23,591 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 08:20:23,591 - INFO - Successfully connected to Supabase.
2025-04-12 08:20:23,695 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 08:20:23,695 - INFO - Migration completed for physician_assignments.
2025-04-12 09:37:01,727 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:01,956 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 09:37:01,961 - INFO - Saved visits per patient data to CSV.
2025-04-12 09:37:02,387 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:02,471 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 09:37:02,472 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 09:37:02,597 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:02,688 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 09:37:02,690 - INFO - Saved average visits per patient data to CSV.
2025-04-12 09:37:02,930 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:03,070 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 09:37:03,072 - INFO - Saved visits per month data to CSV.
2025-04-12 09:37:03,310 - INFO - Starting migration for patient_demographics...
2025-04-12 09:37:03,313 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:03,433 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 09:37:03,433 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 09:37:03,434 - INFO - Successfully connected to Supabase.
2025-04-12 09:37:03,613 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 09:37:03,613 - INFO - Migration completed for patient_demographics.
2025-04-12 09:37:03,613 - INFO - Starting migration for patient_visits...
2025-04-12 09:37:03,615 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:03,700 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 09:37:03,700 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 09:37:03,701 - INFO - Successfully connected to Supabase.
2025-04-12 09:37:03,886 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 09:37:03,886 - INFO - Migration completed for patient_visits.
2025-04-12 09:37:03,886 - INFO - Starting migration for patient_lab_results...
2025-04-12 09:37:03,888 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:04,090 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 09:37:04,090 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 09:37:04,091 - INFO - Successfully connected to Supabase.
2025-04-12 09:37:04,257 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 09:37:04,258 - INFO - Migration completed for patient_lab_results.
2025-04-12 09:37:04,258 - INFO - Starting migration for patient_medications...
2025-04-12 09:37:04,259 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:04,373 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 09:37:04,373 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 09:37:04,374 - INFO - Successfully connected to Supabase.
2025-04-12 09:37:04,619 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 09:37:04,619 - INFO - Migration completed for patient_medications.
2025-04-12 09:37:04,619 - INFO - Starting migration for physician_assignments...
2025-04-12 09:37:04,620 - INFO - Successfully connected to PostgreSQL.
2025-04-12 09:37:04,720 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 09:37:04,720 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 09:37:04,720 - INFO - Successfully connected to Supabase.
2025-04-12 09:37:04,861 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 09:37:04,862 - INFO - Migration completed for physician_assignments.
2025-04-12 12:28:35,502 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:35,718 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:28:35,720 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:28:36,682 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:36,755 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:28:36,757 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:28:36,860 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:37,028 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:28:37,029 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:28:37,178 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:37,225 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:28:37,225 - INFO - Saved visits per month data to CSV.
2025-04-12 12:28:37,341 - INFO - Starting migration for patient_demographics...
2025-04-12 12:28:37,342 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:37,399 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:28:37,399 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:28:37,399 - INFO - Successfully connected to Supabase.
2025-04-12 12:28:37,551 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:28:37,551 - INFO - Migration completed for patient_demographics.
2025-04-12 12:28:37,552 - INFO - Starting migration for patient_visits...
2025-04-12 12:28:37,553 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:37,750 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:28:37,750 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:28:37,751 - INFO - Successfully connected to Supabase.
2025-04-12 12:28:37,838 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:28:37,838 - INFO - Migration completed for patient_visits.
2025-04-12 12:28:37,838 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:28:37,838 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:37,886 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:28:37,886 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:28:37,886 - INFO - Successfully connected to Supabase.
2025-04-12 12:28:37,992 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:28:37,992 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:28:37,992 - INFO - Starting migration for patient_medications...
2025-04-12 12:28:37,992 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:38,044 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:28:38,044 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:28:38,045 - INFO - Successfully connected to Supabase.
2025-04-12 12:28:38,144 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:28:38,144 - INFO - Migration completed for patient_medications.
2025-04-12 12:28:38,144 - INFO - Starting migration for physician_assignments...
2025-04-12 12:28:38,145 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:28:38,208 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:28:38,208 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:28:38,209 - INFO - Successfully connected to Supabase.
2025-04-12 12:28:38,310 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:28:38,310 - INFO - Migration completed for physician_assignments.
2025-04-12 12:43:51,619 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:51,714 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:43:51,716 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:43:51,981 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:52,035 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'ANXIETY'
    OR (visit_date BETWEEN '2022-06-01' AND '2022-12-31')
    
2025-04-12 12:43:52,037 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:43:52,129 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:52,186 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:43:52,188 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:43:52,348 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:52,394 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:43:52,395 - INFO - Saved visits per month data to CSV.
2025-04-12 12:43:52,511 - INFO - Starting migration for patient_demographics...
2025-04-12 12:43:52,511 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:52,670 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:43:52,670 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:43:52,670 - INFO - Successfully connected to Supabase.
2025-04-12 12:43:52,803 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:43:52,804 - INFO - Migration completed for patient_demographics.
2025-04-12 12:43:52,804 - INFO - Starting migration for patient_visits...
2025-04-12 12:43:52,804 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:52,863 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:43:52,863 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:43:52,864 - INFO - Successfully connected to Supabase.
2025-04-12 12:43:52,980 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:43:52,980 - INFO - Migration completed for patient_visits.
2025-04-12 12:43:52,980 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:43:52,981 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:53,143 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:43:53,143 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:43:53,143 - INFO - Successfully connected to Supabase.
2025-04-12 12:43:53,257 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:43:53,257 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:43:53,257 - INFO - Starting migration for patient_medications...
2025-04-12 12:43:53,258 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:53,323 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:43:53,324 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:43:53,324 - INFO - Successfully connected to Supabase.
2025-04-12 12:43:53,409 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:43:53,410 - INFO - Migration completed for patient_medications.
2025-04-12 12:43:53,410 - INFO - Starting migration for physician_assignments...
2025-04-12 12:43:53,410 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:43:53,462 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:43:53,463 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:43:53,463 - INFO - Successfully connected to Supabase.
2025-04-12 12:43:53,566 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:43:53,566 - INFO - Migration completed for physician_assignments.
2025-04-12 12:45:32,872 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:32,927 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:45:32,930 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:45:33,127 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:33,173 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'ANXIETY'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:45:33,174 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:45:33,264 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:33,312 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:45:33,313 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:45:33,461 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:33,510 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:45:33,510 - INFO - Saved visits per month data to CSV.
2025-04-12 12:45:33,624 - INFO - Starting migration for patient_demographics...
2025-04-12 12:45:33,625 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:33,673 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:45:33,673 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:45:33,674 - INFO - Successfully connected to Supabase.
2025-04-12 12:45:33,824 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:45:33,824 - INFO - Migration completed for patient_demographics.
2025-04-12 12:45:33,824 - INFO - Starting migration for patient_visits...
2025-04-12 12:45:33,825 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:33,986 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:45:33,986 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:45:33,986 - INFO - Successfully connected to Supabase.
2025-04-12 12:45:34,073 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:45:34,073 - INFO - Migration completed for patient_visits.
2025-04-12 12:45:34,074 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:45:34,074 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:34,130 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:45:34,130 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:45:34,131 - INFO - Successfully connected to Supabase.
2025-04-12 12:45:34,231 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:45:34,231 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:45:34,231 - INFO - Starting migration for patient_medications...
2025-04-12 12:45:34,231 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:34,279 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:45:34,279 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:45:34,280 - INFO - Successfully connected to Supabase.
2025-04-12 12:45:34,398 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:45:34,398 - INFO - Migration completed for patient_medications.
2025-04-12 12:45:34,398 - INFO - Starting migration for physician_assignments...
2025-04-12 12:45:34,399 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:45:34,460 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:45:34,460 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:45:34,460 - INFO - Successfully connected to Supabase.
2025-04-12 12:45:34,561 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:45:34,561 - INFO - Migration completed for physician_assignments.
2025-04-12 12:47:51,573 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:51,629 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:47:51,631 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:47:51,831 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:51,880 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'ANXIETY'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:47:51,881 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:47:51,969 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:52,014 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:47:52,015 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:47:52,183 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:52,227 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:47:52,229 - INFO - Saved visits per month data to CSV.
2025-04-12 12:47:52,353 - INFO - Starting migration for patient_demographics...
2025-04-12 12:47:52,354 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:52,399 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:47:52,399 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:47:52,399 - INFO - Successfully connected to Supabase.
2025-04-12 12:47:52,486 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:47:52,486 - INFO - Migration completed for patient_demographics.
2025-04-12 12:47:52,486 - INFO - Starting migration for patient_visits...
2025-04-12 12:47:52,487 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:52,543 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:47:52,543 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:47:52,544 - INFO - Successfully connected to Supabase.
2025-04-12 12:47:52,645 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:47:52,645 - INFO - Migration completed for patient_visits.
2025-04-12 12:47:52,645 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:47:52,645 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:52,689 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:47:52,689 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:47:52,690 - INFO - Successfully connected to Supabase.
2025-04-12 12:47:52,850 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:47:52,850 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:47:52,850 - INFO - Starting migration for patient_medications...
2025-04-12 12:47:52,851 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:52,904 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:47:52,904 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:47:52,904 - INFO - Successfully connected to Supabase.
2025-04-12 12:47:52,994 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:47:52,995 - INFO - Migration completed for patient_medications.
2025-04-12 12:47:52,995 - INFO - Starting migration for physician_assignments...
2025-04-12 12:47:52,995 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:47:53,050 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:47:53,050 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:47:53,051 - INFO - Successfully connected to Supabase.
2025-04-12 12:47:53,163 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:47:53,163 - INFO - Migration completed for physician_assignments.
2025-04-12 12:48:33,580 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:33,631 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:48:33,634 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:48:33,821 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:33,868 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'ANXIETY'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:48:33,869 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:48:33,958 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:34,002 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:48:34,003 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:48:34,158 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:34,205 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:48:34,206 - INFO - Saved visits per month data to CSV.
2025-04-12 12:48:34,318 - INFO - Starting migration for patient_demographics...
2025-04-12 12:48:34,319 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:34,370 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:48:34,370 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:48:34,371 - INFO - Successfully connected to Supabase.
2025-04-12 12:48:34,468 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:48:34,468 - INFO - Migration completed for patient_demographics.
2025-04-12 12:48:34,468 - INFO - Starting migration for patient_visits...
2025-04-12 12:48:34,469 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:34,624 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:48:34,624 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:48:34,625 - INFO - Successfully connected to Supabase.
2025-04-12 12:48:34,701 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:48:34,701 - INFO - Migration completed for patient_visits.
2025-04-12 12:48:34,701 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:48:34,703 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:34,759 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:48:34,759 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:48:34,759 - INFO - Successfully connected to Supabase.
2025-04-12 12:48:34,845 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:48:34,845 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:48:34,845 - INFO - Starting migration for patient_medications...
2025-04-12 12:48:34,846 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:34,886 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:48:34,886 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:48:34,887 - INFO - Successfully connected to Supabase.
2025-04-12 12:48:34,964 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:48:34,965 - INFO - Migration completed for patient_medications.
2025-04-12 12:48:34,965 - INFO - Starting migration for physician_assignments...
2025-04-12 12:48:34,965 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:48:35,012 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:48:35,012 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:48:35,012 - INFO - Successfully connected to Supabase.
2025-04-12 12:48:35,125 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:48:35,125 - INFO - Migration completed for physician_assignments.
2025-04-12 12:49:01,434 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:01,485 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:49:01,487 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:49:01,684 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:01,739 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'ANXIETY'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:49:01,740 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:49:01,832 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:01,876 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:49:01,877 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:49:02,025 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:02,075 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:49:02,075 - INFO - Saved visits per month data to CSV.
2025-04-12 12:49:02,193 - INFO - Starting migration for patient_demographics...
2025-04-12 12:49:02,194 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:02,240 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:49:02,240 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:49:02,240 - INFO - Successfully connected to Supabase.
2025-04-12 12:49:02,330 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:49:02,331 - INFO - Migration completed for patient_demographics.
2025-04-12 12:49:02,331 - INFO - Starting migration for patient_visits...
2025-04-12 12:49:02,332 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:02,416 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:49:02,416 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:49:02,417 - INFO - Successfully connected to Supabase.
2025-04-12 12:49:02,518 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:49:02,518 - INFO - Migration completed for patient_visits.
2025-04-12 12:49:02,518 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:49:02,519 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:02,561 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:49:02,561 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:49:02,562 - INFO - Successfully connected to Supabase.
2025-04-12 12:49:02,650 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:49:02,650 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:49:02,650 - INFO - Starting migration for patient_medications...
2025-04-12 12:49:02,651 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:02,706 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:49:02,706 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:49:02,707 - INFO - Successfully connected to Supabase.
2025-04-12 12:49:02,821 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:49:02,821 - INFO - Migration completed for patient_medications.
2025-04-12 12:49:02,821 - INFO - Starting migration for physician_assignments...
2025-04-12 12:49:02,822 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:49:02,874 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:49:02,874 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:49:02,875 - INFO - Successfully connected to Supabase.
2025-04-12 12:49:02,968 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:49:02,968 - INFO - Migration completed for physician_assignments.
2025-04-12 12:50:13,691 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:13,746 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:50:13,749 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:50:13,939 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:13,989 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'ANXIETY'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:50:13,990 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:50:14,079 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:14,132 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:50:14,133 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:50:14,279 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:14,328 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:50:14,329 - INFO - Saved visits per month data to CSV.
2025-04-12 12:50:14,442 - INFO - Starting migration for patient_demographics...
2025-04-12 12:50:14,443 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:14,489 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:50:14,489 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:50:14,489 - INFO - Successfully connected to Supabase.
2025-04-12 12:50:14,584 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:50:14,584 - INFO - Migration completed for patient_demographics.
2025-04-12 12:50:14,584 - INFO - Starting migration for patient_visits...
2025-04-12 12:50:14,585 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:14,639 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:50:14,639 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:50:14,640 - INFO - Successfully connected to Supabase.
2025-04-12 12:50:14,731 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:50:14,731 - INFO - Migration completed for patient_visits.
2025-04-12 12:50:14,731 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:50:14,731 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:14,773 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:50:14,773 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:50:14,774 - INFO - Successfully connected to Supabase.
2025-04-12 12:50:14,870 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:50:14,870 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:50:14,870 - INFO - Starting migration for patient_medications...
2025-04-12 12:50:14,871 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:14,918 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:50:14,918 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:50:14,918 - INFO - Successfully connected to Supabase.
2025-04-12 12:50:15,002 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:50:15,002 - INFO - Migration completed for patient_medications.
2025-04-12 12:50:15,002 - INFO - Starting migration for physician_assignments...
2025-04-12 12:50:15,002 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:50:15,053 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:50:15,053 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:50:15,054 - INFO - Successfully connected to Supabase.
2025-04-12 12:50:15,162 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:50:15,163 - INFO - Migration completed for physician_assignments.
2025-04-12 12:52:34,873 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:34,930 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 12:52:34,932 - INFO - Saved visits per patient data to CSV.
2025-04-12 12:52:35,132 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:35,184 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 12:52:35,185 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 12:52:35,274 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:35,320 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 12:52:35,321 - INFO - Saved average visits per patient data to CSV.
2025-04-12 12:52:35,470 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:35,519 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 12:52:35,519 - INFO - Saved visits per month data to CSV.
2025-04-12 12:52:35,633 - INFO - Starting migration for patient_demographics...
2025-04-12 12:52:35,633 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:35,682 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 12:52:35,682 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 12:52:35,682 - INFO - Successfully connected to Supabase.
2025-04-12 12:52:35,782 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 12:52:35,782 - INFO - Migration completed for patient_demographics.
2025-04-12 12:52:35,783 - INFO - Starting migration for patient_visits...
2025-04-12 12:52:35,783 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:35,847 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 12:52:35,847 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 12:52:35,847 - INFO - Successfully connected to Supabase.
2025-04-12 12:52:35,952 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 12:52:35,952 - INFO - Migration completed for patient_visits.
2025-04-12 12:52:35,952 - INFO - Starting migration for patient_lab_results...
2025-04-12 12:52:35,953 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:35,997 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 12:52:35,997 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 12:52:35,998 - INFO - Successfully connected to Supabase.
2025-04-12 12:52:36,098 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 12:52:36,098 - INFO - Migration completed for patient_lab_results.
2025-04-12 12:52:36,098 - INFO - Starting migration for patient_medications...
2025-04-12 12:52:36,099 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:36,144 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 12:52:36,144 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 12:52:36,145 - INFO - Successfully connected to Supabase.
2025-04-12 12:52:36,252 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 12:52:36,252 - INFO - Migration completed for patient_medications.
2025-04-12 12:52:36,252 - INFO - Starting migration for physician_assignments...
2025-04-12 12:52:36,253 - INFO - Successfully connected to PostgreSQL.
2025-04-12 12:52:36,303 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 12:52:36,303 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 12:52:36,304 - INFO - Successfully connected to Supabase.
2025-04-12 12:52:36,399 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 12:52:36,399 - INFO - Migration completed for physician_assignments.
2025-04-12 18:20:22,971 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:23,042 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 18:20:23,046 - INFO - Saved visits per patient data to CSV.
2025-04-12 18:20:23,454 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:23,515 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 18:20:23,516 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 18:20:23,638 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:23,698 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 18:20:23,699 - INFO - Saved average visits per patient data to CSV.
2025-04-12 18:20:23,909 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:24,092 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 18:20:24,093 - INFO - Saved visits per month data to CSV.
2025-04-12 18:20:24,276 - INFO - Starting migration for patient_demographics...
2025-04-12 18:20:24,277 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:24,335 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 18:20:24,335 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 18:20:24,336 - INFO - Successfully connected to Supabase.
2025-04-12 18:20:24,478 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 18:20:24,478 - INFO - Migration completed for patient_demographics.
2025-04-12 18:20:24,478 - INFO - Starting migration for patient_visits...
2025-04-12 18:20:24,479 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:24,561 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 18:20:24,561 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 18:20:24,562 - INFO - Successfully connected to Supabase.
2025-04-12 18:20:24,675 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 18:20:24,675 - INFO - Migration completed for patient_visits.
2025-04-12 18:20:24,675 - INFO - Starting migration for patient_lab_results...
2025-04-12 18:20:24,676 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:24,731 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 18:20:24,731 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 18:20:24,731 - INFO - Successfully connected to Supabase.
2025-04-12 18:20:24,830 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 18:20:24,830 - INFO - Migration completed for patient_lab_results.
2025-04-12 18:20:24,830 - INFO - Starting migration for patient_medications...
2025-04-12 18:20:24,831 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:25,006 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 18:20:25,007 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 18:20:25,007 - INFO - Successfully connected to Supabase.
2025-04-12 18:20:25,112 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 18:20:25,112 - INFO - Migration completed for patient_medications.
2025-04-12 18:20:25,112 - INFO - Starting migration for physician_assignments...
2025-04-12 18:20:25,112 - INFO - Successfully connected to PostgreSQL.
2025-04-12 18:20:25,322 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 18:20:25,322 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 18:20:25,323 - INFO - Successfully connected to Supabase.
2025-04-12 18:20:25,454 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 18:20:25,454 - INFO - Migration completed for physician_assignments.
2025-04-12 21:05:22,198 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:22,333 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    ORDER BY patient_id;
    
2025-04-12 21:05:22,338 - INFO - Saved visits per patient data to CSV.
2025-04-12 21:05:22,789 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:22,888 - INFO - Query executed successfully: 
    SELECT patient_id, diagnosis, visit_date
    FROM patient_visits
    WHERE diagnosis = 'DEPRESSION'
    OR (visit_date BETWEEN '2023-01-01' AND '2023-12-31')
    
2025-04-12 21:05:22,892 - INFO - Saved patients by diagnosis to CSV.
2025-04-12 21:05:23,057 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:23,156 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-12 21:05:23,159 - INFO - Saved average visits per patient data to CSV.
2025-04-12 21:05:23,362 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:23,431 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-12 21:05:23,433 - INFO - Saved visits per month data to CSV.
2025-04-12 21:05:23,586 - INFO - Starting migration for patient_demographics...
2025-04-12 21:05:23,587 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:23,653 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-12 21:05:23,654 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-12 21:05:23,654 - INFO - Successfully connected to Supabase.
2025-04-12 21:05:23,937 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-12 21:05:23,937 - INFO - Migration completed for patient_demographics.
2025-04-12 21:05:23,937 - INFO - Starting migration for patient_visits...
2025-04-12 21:05:23,938 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:24,021 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-12 21:05:24,021 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-12 21:05:24,021 - INFO - Successfully connected to Supabase.
2025-04-12 21:05:24,152 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-12 21:05:24,152 - INFO - Migration completed for patient_visits.
2025-04-12 21:05:24,152 - INFO - Starting migration for patient_lab_results...
2025-04-12 21:05:24,152 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:24,218 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-12 21:05:24,218 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-12 21:05:24,218 - INFO - Successfully connected to Supabase.
2025-04-12 21:05:24,349 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-12 21:05:24,349 - INFO - Migration completed for patient_lab_results.
2025-04-12 21:05:24,349 - INFO - Starting migration for patient_medications...
2025-04-12 21:05:24,350 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:24,431 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-12 21:05:24,432 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-12 21:05:24,433 - INFO - Successfully connected to Supabase.
2025-04-12 21:05:24,546 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-12 21:05:24,546 - INFO - Migration completed for patient_medications.
2025-04-12 21:05:24,546 - INFO - Starting migration for physician_assignments...
2025-04-12 21:05:24,546 - INFO - Successfully connected to PostgreSQL.
2025-04-12 21:05:24,612 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-12 21:05:24,612 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-12 21:05:24,612 - INFO - Successfully connected to Supabase.
2025-04-12 21:05:24,733 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-12 21:05:24,733 - INFO - Migration completed for physician_assignments.
