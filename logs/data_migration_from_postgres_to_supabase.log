2025-03-29 10:35:46,076 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,175 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 10:35:46,179 - INFO - Saved visits per patient data to CSV.
2025-03-29 10:35:46,186 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,250 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 10:35:46,258 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,315 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 10:35:46,317 - INFO - Saved average visits per patient data to CSV.
2025-03-29 10:35:46,326 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,386 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 10:35:46,390 - INFO - Starting migration for patient_demographics...
2025-03-29 10:35:46,390 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,446 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-29 10:35:46,446 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-29 10:35:46,447 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,533 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-29 10:35:46,533 - INFO - Migration completed for patient_demographics.
2025-03-29 10:35:46,533 - INFO - Starting migration for patient_visits...
2025-03-29 10:35:46,534 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,584 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-29 10:35:46,584 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-29 10:35:46,585 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,659 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-29 10:35:46,659 - INFO - Migration completed for patient_visits.
2025-03-29 10:35:46,659 - INFO - Starting migration for patient_lab_results...
2025-03-29 10:35:46,660 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,711 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-29 10:35:46,711 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-29 10:35:46,712 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,759 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-29 10:35:46,759 - INFO - Migration completed for patient_lab_results.
2025-03-29 10:35:46,759 - INFO - Starting migration for patient_medications...
2025-03-29 10:35:46,759 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,814 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-29 10:35:46,814 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-29 10:35:46,815 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,874 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-29 10:35:46,874 - INFO - Migration completed for patient_medications.
2025-03-29 10:35:46,874 - INFO - Starting migration for physician_assignments...
2025-03-29 10:35:46,875 - INFO - Successfully connected to PostgreSQL.
2025-03-29 10:35:46,927 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-29 10:35:46,927 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-29 10:35:46,928 - INFO - Successfully connected to Supabase.
2025-03-29 10:35:46,987 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-29 10:35:46,987 - INFO - Migration completed for physician_assignments.
2025-03-29 16:40:31,612 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:31,784 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 16:40:31,797 - INFO - Saved visits per patient data to CSV.
2025-03-29 16:40:31,816 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:31,891 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 16:40:31,899 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:31,963 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 16:40:31,964 - INFO - Saved average visits per patient data to CSV.
2025-03-29 16:40:31,971 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,027 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 16:40:32,030 - INFO - Starting migration for data_migration.patient_demographics...
2025-03-29 16:40:32,031 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,077 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_demographics" does not exist
LINE 1: SELECT * FROM data_migration.patient_demographics;
                      ^

[SQL: SELECT * FROM data_migration.patient_demographics;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,077 - INFO - Fetched data from PostgreSQL table data_migration.patient_demographics.
2025-03-29 16:40:32,077 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,077 - ERROR - Error inserting data into Supabase table data_migration.patient_demographics: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,077 - INFO - Migration completed for data_migration.patient_demographics.
2025-03-29 16:40:32,077 - INFO - Starting migration for data_migration.patient_visits...
2025-03-29 16:40:32,078 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,124 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_visits" does not exist
LINE 1: SELECT * FROM data_migration.patient_visits;
                      ^

[SQL: SELECT * FROM data_migration.patient_visits;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,124 - INFO - Fetched data from PostgreSQL table data_migration.patient_visits.
2025-03-29 16:40:32,125 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,125 - ERROR - Error inserting data into Supabase table data_migration.patient_visits: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,125 - INFO - Migration completed for data_migration.patient_visits.
2025-03-29 16:40:32,125 - INFO - Starting migration for data_migration.patient_lab_results...
2025-03-29 16:40:32,125 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,184 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_lab_results" does not exist
LINE 1: SELECT * FROM data_migration.patient_lab_results;
                      ^

[SQL: SELECT * FROM data_migration.patient_lab_results;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,184 - INFO - Fetched data from PostgreSQL table data_migration.patient_lab_results.
2025-03-29 16:40:32,185 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,185 - ERROR - Error inserting data into Supabase table data_migration.patient_lab_results: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,185 - INFO - Migration completed for data_migration.patient_lab_results.
2025-03-29 16:40:32,185 - INFO - Starting migration for data_migration.patient_medications...
2025-03-29 16:40:32,186 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,238 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_medications" does not exist
LINE 1: SELECT * FROM data_migration.patient_medications;
                      ^

[SQL: SELECT * FROM data_migration.patient_medications;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,238 - INFO - Fetched data from PostgreSQL table data_migration.patient_medications.
2025-03-29 16:40:32,239 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,239 - ERROR - Error inserting data into Supabase table data_migration.patient_medications: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,239 - INFO - Migration completed for data_migration.patient_medications.
2025-03-29 16:40:32,239 - INFO - Starting migration for data_migration.physician_assignments...
2025-03-29 16:40:32,239 - INFO - Successfully connected to PostgreSQL.
2025-03-29 16:40:32,283 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.physician_assignments" does not exist
LINE 1: SELECT * FROM data_migration.physician_assignments;
                      ^

[SQL: SELECT * FROM data_migration.physician_assignments;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 16:40:32,283 - INFO - Fetched data from PostgreSQL table data_migration.physician_assignments.
2025-03-29 16:40:32,284 - INFO - Successfully connected to Supabase.
2025-03-29 16:40:32,284 - ERROR - Error inserting data into Supabase table data_migration.physician_assignments: 'NoneType' object has no attribute 'to_sql'
2025-03-29 16:40:32,284 - INFO - Migration completed for data_migration.physician_assignments.
2025-03-29 17:03:13,740 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:13,821 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 17:03:13,828 - INFO - Saved visits per patient data to CSV.
2025-03-29 17:03:13,835 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,007 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 17:03:14,015 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,070 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 17:03:14,072 - INFO - Saved average visits per patient data to CSV.
2025-03-29 17:03:14,077 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,137 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 17:03:14,142 - INFO - Starting migration for data_migration.patient_demographics...
2025-03-29 17:03:14,142 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,189 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_demographics" does not exist
LINE 1: SELECT * FROM data_migration.patient_demographics;
                      ^

[SQL: SELECT * FROM data_migration.patient_demographics;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,189 - INFO - Fetched data from PostgreSQL table data_migration.patient_demographics.
2025-03-29 17:03:14,190 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,190 - ERROR - Error inserting data into Supabase table data_migration.patient_demographics: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,190 - INFO - Migration completed for data_migration.patient_demographics.
2025-03-29 17:03:14,190 - INFO - Starting migration for data_migration.patient_visits...
2025-03-29 17:03:14,191 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,240 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_visits" does not exist
LINE 1: SELECT * FROM data_migration.patient_visits;
                      ^

[SQL: SELECT * FROM data_migration.patient_visits;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,240 - INFO - Fetched data from PostgreSQL table data_migration.patient_visits.
2025-03-29 17:03:14,241 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,241 - ERROR - Error inserting data into Supabase table data_migration.patient_visits: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,241 - INFO - Migration completed for data_migration.patient_visits.
2025-03-29 17:03:14,241 - INFO - Starting migration for data_migration.patient_lab_results...
2025-03-29 17:03:14,242 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,283 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_lab_results" does not exist
LINE 1: SELECT * FROM data_migration.patient_lab_results;
                      ^

[SQL: SELECT * FROM data_migration.patient_lab_results;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,283 - INFO - Fetched data from PostgreSQL table data_migration.patient_lab_results.
2025-03-29 17:03:14,283 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,284 - ERROR - Error inserting data into Supabase table data_migration.patient_lab_results: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,284 - INFO - Migration completed for data_migration.patient_lab_results.
2025-03-29 17:03:14,284 - INFO - Starting migration for data_migration.patient_medications...
2025-03-29 17:03:14,284 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,333 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.patient_medications" does not exist
LINE 1: SELECT * FROM data_migration.patient_medications;
                      ^

[SQL: SELECT * FROM data_migration.patient_medications;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,334 - INFO - Fetched data from PostgreSQL table data_migration.patient_medications.
2025-03-29 17:03:14,334 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,334 - ERROR - Error inserting data into Supabase table data_migration.patient_medications: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,334 - INFO - Migration completed for data_migration.patient_medications.
2025-03-29 17:03:14,334 - INFO - Starting migration for data_migration.physician_assignments...
2025-03-29 17:03:14,335 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:03:14,377 - ERROR - Error executing query: (psycopg2.errors.UndefinedTable) relation "data_migration.physician_assignments" does not exist
LINE 1: SELECT * FROM data_migration.physician_assignments;
                      ^

[SQL: SELECT * FROM data_migration.physician_assignments;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-29 17:03:14,377 - INFO - Fetched data from PostgreSQL table data_migration.physician_assignments.
2025-03-29 17:03:14,377 - INFO - Successfully connected to Supabase.
2025-03-29 17:03:14,377 - ERROR - Error inserting data into Supabase table data_migration.physician_assignments: 'NoneType' object has no attribute 'to_sql'
2025-03-29 17:03:14,377 - INFO - Migration completed for data_migration.physician_assignments.
2025-03-29 17:15:46,526 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,582 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-29 17:15:46,587 - INFO - Saved visits per patient data to CSV.
2025-03-29 17:15:46,591 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,645 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-29 17:15:46,652 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,702 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-29 17:15:46,703 - INFO - Saved average visits per patient data to CSV.
2025-03-29 17:15:46,707 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,755 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-29 17:15:46,759 - INFO - Starting migration for patient_demographics...
2025-03-29 17:15:46,759 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,818 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-29 17:15:46,818 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-29 17:15:46,819 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:46,855 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-29 17:15:46,855 - INFO - Migration completed for patient_demographics.
2025-03-29 17:15:46,855 - INFO - Starting migration for patient_visits...
2025-03-29 17:15:46,855 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:46,910 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-29 17:15:46,910 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-29 17:15:46,911 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:46,957 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-29 17:15:46,957 - INFO - Migration completed for patient_visits.
2025-03-29 17:15:46,958 - INFO - Starting migration for patient_lab_results...
2025-03-29 17:15:46,958 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:47,117 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-29 17:15:47,117 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-29 17:15:47,118 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:47,157 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-29 17:15:47,157 - INFO - Migration completed for patient_lab_results.
2025-03-29 17:15:47,157 - INFO - Starting migration for patient_medications...
2025-03-29 17:15:47,158 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:47,224 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-29 17:15:47,224 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-29 17:15:47,225 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:47,283 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-29 17:15:47,283 - INFO - Migration completed for patient_medications.
2025-03-29 17:15:47,284 - INFO - Starting migration for physician_assignments...
2025-03-29 17:15:47,285 - INFO - Successfully connected to PostgreSQL.
2025-03-29 17:15:47,345 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-29 17:15:47,345 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-29 17:15:47,346 - INFO - Successfully connected to Supabase.
2025-03-29 17:15:47,374 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-29 17:15:47,374 - INFO - Migration completed for physician_assignments.
2025-03-30 23:01:59,261 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,338 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-30 23:01:59,341 - INFO - Saved visits per patient data to CSV.
2025-03-30 23:01:59,347 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,399 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-30 23:01:59,409 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,462 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-30 23:01:59,463 - INFO - Saved average visits per patient data to CSV.
2025-03-30 23:01:59,468 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,518 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-30 23:01:59,523 - INFO - Starting migration for patient_demographics...
2025-03-30 23:01:59,524 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,580 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-30 23:01:59,580 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-30 23:01:59,581 - INFO - Successfully connected to Supabase.
2025-03-30 23:01:59,649 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-30 23:01:59,649 - INFO - Migration completed for patient_demographics.
2025-03-30 23:01:59,649 - INFO - Starting migration for patient_visits...
2025-03-30 23:01:59,650 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,715 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-30 23:01:59,715 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-30 23:01:59,716 - INFO - Successfully connected to Supabase.
2025-03-30 23:01:59,770 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-30 23:01:59,770 - INFO - Migration completed for patient_visits.
2025-03-30 23:01:59,770 - INFO - Starting migration for patient_lab_results...
2025-03-30 23:01:59,771 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,835 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-30 23:01:59,836 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-30 23:01:59,836 - INFO - Successfully connected to Supabase.
2025-03-30 23:01:59,900 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-30 23:01:59,900 - INFO - Migration completed for patient_lab_results.
2025-03-30 23:01:59,900 - INFO - Starting migration for patient_medications...
2025-03-30 23:01:59,901 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:01:59,950 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-30 23:01:59,950 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-30 23:01:59,950 - INFO - Successfully connected to Supabase.
2025-03-30 23:02:00,027 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-30 23:02:00,028 - INFO - Migration completed for patient_medications.
2025-03-30 23:02:00,028 - INFO - Starting migration for physician_assignments...
2025-03-30 23:02:00,029 - INFO - Successfully connected to PostgreSQL.
2025-03-30 23:02:00,086 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-30 23:02:00,086 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-30 23:02:00,086 - INFO - Successfully connected to Supabase.
2025-03-30 23:02:00,144 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-30 23:02:00,144 - INFO - Migration completed for physician_assignments.
2025-03-31 08:41:53,651 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,738 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 08:41:53,741 - INFO - Saved visits per patient data to CSV.
2025-03-31 08:41:53,748 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,814 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 08:41:53,828 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,886 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 08:41:53,888 - INFO - Saved average visits per patient data to CSV.
2025-03-31 08:41:53,893 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,949 - ERROR - Error executing query: (psycopg2.errors.UndefinedFunction) function pg_catalog.extract(unknown, text) does not exist
LINE 2:     SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, CO...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 08:41:53,949 - ERROR - Error getting average visits per month: 'NoneType' object has no attribute 'to_csv'
2025-03-31 08:41:53,950 - INFO - Starting migration for patient_demographics...
2025-03-31 08:41:53,950 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:53,998 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 08:41:53,998 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 08:41:53,999 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,059 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 08:41:54,060 - INFO - Migration completed for patient_demographics.
2025-03-31 08:41:54,060 - INFO - Starting migration for patient_visits...
2025-03-31 08:41:54,060 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,114 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 08:41:54,114 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 08:41:54,115 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,180 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 08:41:54,180 - INFO - Migration completed for patient_visits.
2025-03-31 08:41:54,180 - INFO - Starting migration for patient_lab_results...
2025-03-31 08:41:54,181 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,228 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 08:41:54,228 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 08:41:54,228 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,292 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 08:41:54,293 - INFO - Migration completed for patient_lab_results.
2025-03-31 08:41:54,293 - INFO - Starting migration for patient_medications...
2025-03-31 08:41:54,294 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,349 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 08:41:54,349 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 08:41:54,350 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,395 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 08:41:54,395 - INFO - Migration completed for patient_medications.
2025-03-31 08:41:54,395 - INFO - Starting migration for physician_assignments...
2025-03-31 08:41:54,396 - INFO - Successfully connected to PostgreSQL.
2025-03-31 08:41:54,443 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 08:41:54,443 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 08:41:54,444 - INFO - Successfully connected to Supabase.
2025-03-31 08:41:54,506 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 08:41:54,506 - INFO - Migration completed for physician_assignments.
2025-03-31 09:26:40,522 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,594 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:26:40,600 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:26:40,608 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,662 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:26:40,673 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,726 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:26:40,728 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:26:40,734 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,788 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:26:40,792 - INFO - Starting migration for patient_demographics...
2025-03-31 09:26:40,792 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:40,841 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:26:40,841 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:26:40,841 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:40,993 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:26:40,993 - INFO - Migration completed for patient_demographics.
2025-03-31 09:26:40,993 - INFO - Starting migration for patient_visits...
2025-03-31 09:26:40,994 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,050 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:26:41,050 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:26:41,051 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,218 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:26:41,218 - INFO - Migration completed for patient_visits.
2025-03-31 09:26:41,218 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:26:41,218 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,272 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:26:41,272 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:26:41,273 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,398 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:26:41,399 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:26:41,399 - INFO - Starting migration for patient_medications...
2025-03-31 09:26:41,399 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,458 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:26:41,458 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:26:41,459 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,593 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:26:41,593 - INFO - Migration completed for patient_medications.
2025-03-31 09:26:41,593 - INFO - Starting migration for physician_assignments...
2025-03-31 09:26:41,595 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:26:41,665 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:26:41,665 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:26:41,666 - INFO - Successfully connected to Supabase.
2025-03-31 09:26:41,826 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:26:41,827 - INFO - Migration completed for physician_assignments.
2025-03-31 09:28:01,600 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,659 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:28:01,664 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:28:01,670 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,717 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:28:01,727 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,779 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:28:01,780 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:28:01,785 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,839 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:28:01,847 - INFO - Starting migration for patient_demographics...
2025-03-31 09:28:01,847 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:01,903 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:28:01,903 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:28:01,904 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,071 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:28:02,071 - INFO - Migration completed for patient_demographics.
2025-03-31 09:28:02,071 - INFO - Starting migration for patient_visits...
2025-03-31 09:28:02,072 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,126 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:28:02,126 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:28:02,127 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,238 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:28:02,238 - INFO - Migration completed for patient_visits.
2025-03-31 09:28:02,239 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:28:02,239 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,389 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:28:02,389 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:28:02,390 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,499 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:28:02,499 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:28:02,499 - INFO - Starting migration for patient_medications...
2025-03-31 09:28:02,499 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,559 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:28:02,559 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:28:02,559 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,686 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:28:02,686 - INFO - Migration completed for patient_medications.
2025-03-31 09:28:02,686 - INFO - Starting migration for physician_assignments...
2025-03-31 09:28:02,687 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:28:02,837 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:28:02,837 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:28:02,838 - INFO - Successfully connected to Supabase.
2025-03-31 09:28:02,929 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:28:02,930 - INFO - Migration completed for physician_assignments.
2025-03-31 09:34:00,082 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,211 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:34:00,220 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:34:00,234 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,327 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:34:00,342 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,422 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:34:00,423 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:34:00,427 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,477 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:34:00,482 - INFO - Starting migration for patient_demographics...
2025-03-31 09:34:00,482 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,526 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:34:00,526 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:34:00,527 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:00,663 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:34:00,664 - INFO - Migration completed for patient_demographics.
2025-03-31 09:34:00,664 - INFO - Starting migration for patient_visits...
2025-03-31 09:34:00,665 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,760 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:34:00,760 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:34:00,761 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:00,892 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:34:00,892 - INFO - Migration completed for patient_visits.
2025-03-31 09:34:00,892 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:34:00,893 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:00,949 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:34:00,949 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:34:00,950 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:01,114 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:34:01,114 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:34:01,114 - INFO - Starting migration for patient_medications...
2025-03-31 09:34:01,116 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:01,189 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:34:01,189 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:34:01,190 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:01,333 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:34:01,333 - INFO - Migration completed for patient_medications.
2025-03-31 09:34:01,333 - INFO - Starting migration for physician_assignments...
2025-03-31 09:34:01,335 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:34:01,408 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:34:01,408 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:34:01,409 - INFO - Successfully connected to Supabase.
2025-03-31 09:34:01,519 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:34:01,519 - INFO - Migration completed for physician_assignments.
2025-03-31 09:38:51,162 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,228 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 09:38:51,232 - INFO - Saved visits per patient data to CSV.
2025-03-31 09:38:51,240 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,296 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 09:38:51,307 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,367 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 09:38:51,368 - INFO - Saved average visits per patient data to CSV.
2025-03-31 09:38:51,374 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,428 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 09:38:51,435 - INFO - Starting migration for patient_demographics...
2025-03-31 09:38:51,436 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,481 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 09:38:51,481 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 09:38:51,482 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:51,603 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 09:38:51,603 - INFO - Migration completed for patient_demographics.
2025-03-31 09:38:51,603 - INFO - Starting migration for patient_visits...
2025-03-31 09:38:51,604 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,663 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 09:38:51,663 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 09:38:51,664 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:51,779 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 09:38:51,779 - INFO - Migration completed for patient_visits.
2025-03-31 09:38:51,779 - INFO - Starting migration for patient_lab_results...
2025-03-31 09:38:51,780 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:51,827 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 09:38:51,827 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 09:38:51,828 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:51,954 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 09:38:51,954 - INFO - Migration completed for patient_lab_results.
2025-03-31 09:38:51,954 - INFO - Starting migration for patient_medications...
2025-03-31 09:38:51,955 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:52,002 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 09:38:52,002 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 09:38:52,003 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:52,150 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 09:38:52,150 - INFO - Migration completed for patient_medications.
2025-03-31 09:38:52,150 - INFO - Starting migration for physician_assignments...
2025-03-31 09:38:52,151 - INFO - Successfully connected to PostgreSQL.
2025-03-31 09:38:52,212 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 09:38:52,213 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 09:38:52,213 - INFO - Successfully connected to Supabase.
2025-03-31 09:38:52,312 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 09:38:52,312 - INFO - Migration completed for physician_assignments.
2025-03-31 23:01:04,887 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:04,986 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 23:01:04,990 - INFO - Saved visits per patient data to CSV.
2025-03-31 23:01:04,995 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,057 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 23:01:05,067 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,125 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 23:01:05,127 - INFO - Saved average visits per patient data to CSV.
2025-03-31 23:01:05,131 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,181 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 23:01:05,185 - INFO - Starting migration for patient_demographics...
2025-03-31 23:01:05,186 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,234 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 23:01:05,234 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 23:01:05,235 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,269 - ERROR - Error inserting data into Supabase table patient_demographics: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_demographics (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_demographics (
	patient_id TEXT, 
	age BIGINT, 
	age_group TEXT, 
	gender TEXT, 
	patient_demographics_other_fields TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,270 - INFO - Migration completed for patient_demographics.
2025-03-31 23:01:05,270 - INFO - Starting migration for patient_visits...
2025-03-31 23:01:05,270 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,315 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 23:01:05,315 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 23:01:05,315 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,358 - ERROR - Error inserting data into Supabase table patient_visits: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_visits (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_visits (
	patient_id TEXT, 
	visit_id TEXT, 
	visit_date DATE, 
	visit_frequency BIGINT, 
	diagnosis TEXT, 
	medication TEXT, 
	patients_visits_other_fields TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,358 - INFO - Migration completed for patient_visits.
2025-03-31 23:01:05,359 - INFO - Starting migration for patient_lab_results...
2025-03-31 23:01:05,360 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,404 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 23:01:05,405 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 23:01:05,405 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,460 - ERROR - Error inserting data into Supabase table patient_lab_results: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_lab_results (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_lab_results (
	patient_id TEXT, 
	visit_id TEXT, 
	lab_test_id TEXT, 
	test_date DATE, 
	test_name TEXT, 
	result_value FLOAT(53), 
	result_unit TEXT, 
	reference_range TEXT, 
	patient_lab_results_notes TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,460 - INFO - Migration completed for patient_lab_results.
2025-03-31 23:01:05,460 - INFO - Starting migration for patient_medications...
2025-03-31 23:01:05,462 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,504 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 23:01:05,504 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 23:01:05,504 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,531 - ERROR - Error inserting data into Supabase table patient_medications: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.patient_medications (
                     ^

[SQL: 
CREATE TABLE data_migration.patient_medications (
	patient_id TEXT, 
	medication_id TEXT, 
	visit_id TEXT, 
	medication TEXT, 
	dosage_mg FLOAT(53), 
	start_date DATE, 
	end_date DATE, 
	patient_medications_notes TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,531 - INFO - Migration completed for patient_medications.
2025-03-31 23:01:05,531 - INFO - Starting migration for physician_assignments...
2025-03-31 23:01:05,531 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:01:05,576 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 23:01:05,576 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 23:01:05,576 - INFO - Successfully connected to Supabase.
2025-03-31 23:01:05,621 - ERROR - Error inserting data into Supabase table physician_assignments: (psycopg2.errors.InvalidSchemaName) schema "data_migration" does not exist
LINE 2: CREATE TABLE data_migration.physician_assignments (
                     ^

[SQL: 
CREATE TABLE data_migration.physician_assignments (
	patient_id TEXT, 
	visit_id TEXT, 
	physician_id TEXT, 
	physician_name TEXT, 
	assignment_date DATE, 
	department TEXT
)

]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-31 23:01:05,621 - INFO - Migration completed for physician_assignments.
2025-03-31 23:02:21,647 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,743 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-03-31 23:02:21,746 - INFO - Saved visits per patient data to CSV.
2025-03-31 23:02:21,753 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,809 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-03-31 23:02:21,821 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,877 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-03-31 23:02:21,878 - INFO - Saved average visits per patient data to CSV.
2025-03-31 23:02:21,883 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,938 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-03-31 23:02:21,942 - INFO - Starting migration for patient_demographics...
2025-03-31 23:02:21,942 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:21,994 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-03-31 23:02:21,994 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-03-31 23:02:21,994 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,042 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-03-31 23:02:22,042 - INFO - Migration completed for patient_demographics.
2025-03-31 23:02:22,042 - INFO - Starting migration for patient_visits...
2025-03-31 23:02:22,042 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,111 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-03-31 23:02:22,111 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-03-31 23:02:22,112 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,176 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-03-31 23:02:22,177 - INFO - Migration completed for patient_visits.
2025-03-31 23:02:22,177 - INFO - Starting migration for patient_lab_results...
2025-03-31 23:02:22,177 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,229 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-03-31 23:02:22,229 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-03-31 23:02:22,230 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,291 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-03-31 23:02:22,291 - INFO - Migration completed for patient_lab_results.
2025-03-31 23:02:22,291 - INFO - Starting migration for patient_medications...
2025-03-31 23:02:22,292 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,352 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-03-31 23:02:22,352 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-03-31 23:02:22,353 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,424 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-03-31 23:02:22,424 - INFO - Migration completed for patient_medications.
2025-03-31 23:02:22,424 - INFO - Starting migration for physician_assignments...
2025-03-31 23:02:22,425 - INFO - Successfully connected to PostgreSQL.
2025-03-31 23:02:22,509 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-03-31 23:02:22,509 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-03-31 23:02:22,510 - INFO - Successfully connected to Supabase.
2025-03-31 23:02:22,587 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-03-31 23:02:22,587 - INFO - Migration completed for physician_assignments.
2025-04-01 10:28:06,154 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,215 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-04-01 10:28:06,219 - INFO - Saved visits per patient data to CSV.
2025-04-01 10:28:06,225 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,280 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 10:28:06,290 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,338 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 10:28:06,339 - INFO - Saved average visits per patient data to CSV.
2025-04-01 10:28:06,344 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,392 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 10:28:06,396 - INFO - Starting migration for patient_demographics...
2025-04-01 10:28:06,398 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,450 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 10:28:06,450 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 10:28:06,450 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:06,546 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 10:28:06,547 - INFO - Migration completed for patient_demographics.
2025-04-01 10:28:06,547 - INFO - Starting migration for patient_visits...
2025-04-01 10:28:06,547 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,610 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 10:28:06,610 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 10:28:06,611 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:06,708 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 10:28:06,708 - INFO - Migration completed for patient_visits.
2025-04-01 10:28:06,708 - INFO - Starting migration for patient_lab_results...
2025-04-01 10:28:06,709 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,760 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 10:28:06,760 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 10:28:06,761 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:06,872 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 10:28:06,872 - INFO - Migration completed for patient_lab_results.
2025-04-01 10:28:06,872 - INFO - Starting migration for patient_medications...
2025-04-01 10:28:06,873 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:06,924 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 10:28:06,924 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 10:28:06,925 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:07,036 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 10:28:07,036 - INFO - Migration completed for patient_medications.
2025-04-01 10:28:07,036 - INFO - Starting migration for physician_assignments...
2025-04-01 10:28:07,037 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:28:07,089 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 10:28:07,089 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 10:28:07,090 - INFO - Successfully connected to Supabase.
2025-04-01 10:28:07,173 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 10:28:07,173 - INFO - Migration completed for physician_assignments.
2025-04-01 10:53:04,017 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,080 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-04-01 10:53:04,084 - INFO - Saved visits per patient data to CSV.
2025-04-01 10:53:04,090 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,144 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 10:53:04,155 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,312 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 10:53:04,313 - INFO - Saved average visits per patient data to CSV.
2025-04-01 10:53:04,319 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,380 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 10:53:04,389 - INFO - Starting migration for patient_demographics...
2025-04-01 10:53:04,390 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,450 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 10:53:04,450 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 10:53:04,452 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:04,593 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 10:53:04,593 - INFO - Migration completed for patient_demographics.
2025-04-01 10:53:04,593 - INFO - Starting migration for patient_visits...
2025-04-01 10:53:04,594 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,688 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 10:53:04,688 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 10:53:04,688 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:04,867 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 10:53:04,867 - INFO - Migration completed for patient_visits.
2025-04-01 10:53:04,867 - INFO - Starting migration for patient_lab_results...
2025-04-01 10:53:04,868 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:04,923 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 10:53:04,923 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 10:53:04,923 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:05,045 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 10:53:05,045 - INFO - Migration completed for patient_lab_results.
2025-04-01 10:53:05,046 - INFO - Starting migration for patient_medications...
2025-04-01 10:53:05,046 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:05,200 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 10:53:05,200 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 10:53:05,201 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:05,310 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 10:53:05,310 - INFO - Migration completed for patient_medications.
2025-04-01 10:53:05,310 - INFO - Starting migration for physician_assignments...
2025-04-01 10:53:05,311 - INFO - Successfully connected to PostgreSQL.
2025-04-01 10:53:05,369 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 10:53:05,369 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 10:53:05,370 - INFO - Successfully connected to Supabase.
2025-04-01 10:53:05,500 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 10:53:05,500 - INFO - Migration completed for physician_assignments.
2025-04-01 14:23:21,773 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,831 - INFO - Query executed successfully: 
    SELECT patient_id, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) > 1;
    
2025-04-01 14:23:21,834 - INFO - Saved visits per patient data to CSV.
2025-04-01 14:23:21,839 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,887 - INFO - Query executed successfully: 
    SELECT * 
    FROM patient_visits
    WHERE diagnosis = 'Depression'
    OR visit_date BETWEEN '2023-01-01' AND '2023-12-31';
    
2025-04-01 14:23:21,895 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,941 - INFO - Query executed successfully: 
    SELECT patient_id, 
       COUNT(*) AS number_of_visits,
       AVG(COUNT(*)) OVER () AS avg_visits_per_patient
    FROM patient_visits
    GROUP BY patient_id
    HAVING COUNT(*) >= 1  
    ORDER BY patient_id;
    
2025-04-01 14:23:21,942 - INFO - Saved average visits per patient data to CSV.
2025-04-01 14:23:21,948 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:21,998 - INFO - Query executed successfully: 
    SELECT EXTRACT(MONTH FROM visit_date) AS visit_month, COUNT(*) AS number_of_visits
    FROM patient_visits
    GROUP BY EXTRACT(MONTH FROM visit_date)
    ORDER BY visit_month;
    
2025-04-01 14:23:22,002 - INFO - Starting migration for patient_demographics...
2025-04-01 14:23:22,002 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,052 - INFO - Query executed successfully: SELECT * FROM patient_demographics;
2025-04-01 14:23:22,052 - INFO - Fetched data from PostgreSQL table patient_demographics.
2025-04-01 14:23:22,053 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,180 - INFO - Data inserted into patient_demographics successfully in Supabase.
2025-04-01 14:23:22,180 - INFO - Migration completed for patient_demographics.
2025-04-01 14:23:22,180 - INFO - Starting migration for patient_visits...
2025-04-01 14:23:22,181 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,251 - INFO - Query executed successfully: SELECT * FROM patient_visits;
2025-04-01 14:23:22,251 - INFO - Fetched data from PostgreSQL table patient_visits.
2025-04-01 14:23:22,252 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,364 - INFO - Data inserted into patient_visits successfully in Supabase.
2025-04-01 14:23:22,364 - INFO - Migration completed for patient_visits.
2025-04-01 14:23:22,364 - INFO - Starting migration for patient_lab_results...
2025-04-01 14:23:22,365 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,415 - INFO - Query executed successfully: SELECT * FROM patient_lab_results;
2025-04-01 14:23:22,415 - INFO - Fetched data from PostgreSQL table patient_lab_results.
2025-04-01 14:23:22,416 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,539 - INFO - Data inserted into patient_lab_results successfully in Supabase.
2025-04-01 14:23:22,539 - INFO - Migration completed for patient_lab_results.
2025-04-01 14:23:22,539 - INFO - Starting migration for patient_medications...
2025-04-01 14:23:22,540 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,593 - INFO - Query executed successfully: SELECT * FROM patient_medications;
2025-04-01 14:23:22,593 - INFO - Fetched data from PostgreSQL table patient_medications.
2025-04-01 14:23:22,594 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,777 - INFO - Data inserted into patient_medications successfully in Supabase.
2025-04-01 14:23:22,777 - INFO - Migration completed for patient_medications.
2025-04-01 14:23:22,777 - INFO - Starting migration for physician_assignments...
2025-04-01 14:23:22,778 - INFO - Successfully connected to PostgreSQL.
2025-04-01 14:23:22,844 - INFO - Query executed successfully: SELECT * FROM physician_assignments;
2025-04-01 14:23:22,844 - INFO - Fetched data from PostgreSQL table physician_assignments.
2025-04-01 14:23:22,845 - INFO - Successfully connected to Supabase.
2025-04-01 14:23:22,972 - INFO - Data inserted into physician_assignments successfully in Supabase.
2025-04-01 14:23:22,972 - INFO - Migration completed for physician_assignments.
